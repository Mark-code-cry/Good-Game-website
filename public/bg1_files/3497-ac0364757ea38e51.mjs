(self.modernJsonp=self.modernJsonp||[]).push([["3497"],{303151:function(e,t,n){n.d(t,{Z:()=>o});var i=n(69119),a=n(13882);function o(e,t){(0,a.Z)(2,arguments);var n=(0,i.Z)(e),o=(0,i.Z)(t);return n.getTime()===o.getTime()}},307595:function(e,t,n){n.r(t),n.d(t,{default:()=>a});let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CloseupVideoEndCard_pin",selections:[{args:null,kind:"FragmentSpread",name:"useCalculateMaxWidthAndHeightForSideBySideVariant_pin"}],type:"Pin",abstractKey:null};i.hash="e04be51b4be0a2585e7803d004fa83b7";let a=i},60533:function(e,t,n){n.r(t),n.d(t,{default:()=>a});let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CloseupVideoNonDuplo_pin",selections:[{args:null,kind:"FragmentSpread",name:"CloseupVideoEndCard_pin"},{args:null,kind:"FragmentSpread",name:"VideoWithContextLogging_pin"},{args:null,kind:"FragmentSpread",name:"useCalculateMaxWidthAndHeightForSideBySideVariant_pin"}],type:"Pin",abstractKey:null};i.hash="53ae9ecd15f057f744460205e5d495fd";let a=i},35312:function(e,t,n){n.r(t),n.d(t,{default:()=>a});let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"StoryPinBlock_pin",selections:[{args:null,kind:"FragmentSpread",name:"StoryPinStickerBlockCloseup_pin"}],type:"Pin",abstractKey:null};i.hash="8bb1bb1f7bafeed0fe43bed44ef12d2a";let a=i},303965:function(e,t,n){n.r(t),n.d(t,{default:()=>a});let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"StoryPinStickerBlockCloseup_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gridTitle",storageKey:null},{alias:"imageSpec_236x",args:[{kind:"Literal",name:"spec",value:"236x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:'images(spec:"236x")'},{alias:null,args:null,concreteType:"RichPinGridData",kind:"LinkedField",name:"richSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null},{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[{alias:null,args:null,concreteType:"OfferSummary",kind:"LinkedField",name:"offerSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxPrice",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Pin",abstractKey:null};i.hash="7e8d917850c8329247291df0d281a59b";let a=i},454387:function(e,t,n){n.r(t),n.d(t,{default:()=>a});let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VideoWithContextLogging_pin",selections:[{args:null,kind:"FragmentSpread",name:"VideoWrapper_pin"}],type:"Pin",abstractKey:null};i.hash="93ed23334d5bac81ac8410f05c4f2031";let a=i},111419:function(e,t,n){n.r(t),n.d(t,{default:()=>a});let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useCalculateImageContainerDimension_pin",selections:[{args:null,kind:"FragmentSpread",name:"useCalculateMaxWidthAndHeightForSideBySideVariant_pin"}],type:"Pin",abstractKey:null};i.hash="86a6c49cecdb70d77f786a1965756cf9";let a=i},331047:function(e,t,n){var i,a,o,s;n.r(t),n.d(t,{default:()=>r});let l=(i={alias:null,args:null,kind:"ScalarField",name:"domain",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null},s=[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"officialUser",plural:!1,selections:o=[{alias:null,args:null,kind:"ScalarField",name:"firstName",storageKey:null}],storageKey:null}],{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useCalculateMaxWidthAndHeightForSideBySideVariant_pin",selections:[{alias:null,args:null,concreteType:"PinCarouselData",kind:"LinkedField",name:"carouselData",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"index",storageKey:null},{alias:null,args:null,concreteType:"PinCarouselSlot",kind:"LinkedField",name:"carouselSlots",plural:!0,selections:[i,a],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"closeupAttribution",plural:!1,selections:o,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedTitle",storageKey:null},i,{alias:null,args:null,kind:"ScalarField",name:"gridTitle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isEligibleForPdp",storageKey:null},a,{alias:null,args:null,concreteType:"Domain",kind:"LinkedField",name:"linkDomain",plural:!1,selections:s,storageKey:null},{alias:null,args:null,concreteType:"UserWebsite",kind:"LinkedField",name:"linkUserWebsite",plural:!1,selections:s,storageKey:null},{alias:null,args:null,concreteType:"RichPinDataView",kind:"LinkedField",name:"richMetadata",plural:!1,selections:[{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[{alias:null,args:null,concreteType:"OfferSummary",kind:"LinkedField",name:"offerSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"standardPrice",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"trackedLink",storageKey:null}],type:"Pin",abstractKey:null});l.hash="b2a27d44d1f3dbd42301b82866212272";let r=l},707915:function(e,t,n){n.d(t,{Z:()=>l});var i=n(667294),a=n(20256),o=n(601686),s=n(785893);let l=(0,i.forwardRef)(({accessibilityLabel:e,handleClick:t,icon:n,iconColor:l,iconOnly:r,testId:d,buttonText:c,tabIndex:u,bgColor:p,isActive:h},m)=>{let[g,y]=(0,i.useState)(!1),_=(0,i.useRef)(null);(0,i.useImperativeHandle)(m,()=>_.current);let{setAbortNoActionPlacementTimeout:f}=(0,o.x4)(),b=()=>{y(e=>!e),t(),f(!0)},v=e=>{_&&e.target instanceof Element&&!_.current?.contains(e.target)&&y(!1)};return(0,i.useEffect)(()=>(window.addEventListener("mousedown",v),()=>{window.removeEventListener("mousedown",v)}),[]),(0,i.useEffect)(()=>{void 0!==h&&y(h)},[h]),(0,s.jsx)(a.xu,{"data-test-id":d||"closeup-action-bar-button",children:(0,s.jsxs)(a.kC,{alignItems:"center",justifyContent:"start",children:[(0,s.jsx)(a.hU,{ref:_,accessibilityLabel:e,bgColor:p,icon:n,iconColor:l||"darkGray",onClick:b,selected:g,size:r?"md":"lg",tabIndex:u}),c&&(0,s.jsx)(a.iP,{onTap:b,rounding:2,children:(0,s.jsx)(a.X6,{color:"light",overflow:"normal",size:"400",children:c})})]})})})},856782:function(e,t,n){n.d(t,{S:()=>i,Z:()=>a});let i=1e3,a=3},112931:function(e,t,n){n.d(t,{ZP:()=>m,GJ:()=>h});var i,a=n(667294);n(422578);var o=n(592821),s=n(979904),l=n(139707),r=n(974297),d=n(28427),c=n(611499),u=n(601686);let p=(void 0!==i||(i=n(111419)).hash&&"86a6c49cecdb70d77f786a1965756cf9"!==i.hash&&console.error("The definition of 'useCalculateImageContainerDimension_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i);function h(e,t){return`${Math.floor(e/t*1e4)/1e4} / 1`}function m({carouselData:e,imageToDisplayWidthRatio:t=1,mainImage:n={width:1,height:1,url:""},maxCloseupImageWidth:i,pinKey:h,shouldPadImage:m=!1}){let g=(0,d.Z)(p,h),{peekCloseupEnabled:y,viewportSize:_}=(0,u.x4)(),{numericValues:f}=(0,o.Re)(),{maxHeight:b}=(0,s.Z)({pinKey:g}),{fiftyPercentHeight:v,fiftyPercentWidth:x,maxHeight:P,maxWidth:S}=f??{},{peekRedesignFastFollowsEnabled:w}=(0,l.Z)(n);return(0,a.useMemo)(()=>{let a,o=i-c.d2,s=Math.min(m?o:i,S??1/0,x??1/0),l=Math.min(...[n,...e?.carousel_slots?.map(e=>{var t;return(0,r.Z)(e.images)||((t=e.videos?.video_list)?t.V_720P?.url?t.V_720P:t.V_HLSV4?.url?t.V_HLSV4:t.V_HLSV3_MOBILE?.url?t.V_HLSV3_MOBILE:t.V_HLSV3_WEB?.url?t.V_HLSV3_WEB:null:null)}).filter(e=>!!e)||[]].map(({width:e,height:t})=>(e??1)/(t??1))),d=Math.floor(s*(e?t:1)/l),u="sm"===_?v:P;a=y?u??d:"number"==typeof b?b:d;let p=w?void 0:a,h=p?Math.min(d,p):d,g=Math.min(s*(y?h/d:1),S??1/0,x??1/0),{containerAspectRatio:f,letterBoxedWidth:C,letterBoxedHeight:k}=function(e,t,n){let i,a,o=e?.width/e.height,s=t/n;return o>s?(i=t,a=t/o):(i=n*o,a=n),{containerAspectRatio:s,letterBoxedWidth:i,letterBoxedHeight:a}}(n,g,h);return{containerAspectRatio:f,containerHeight:h,containerWidth:g,horizontalOffset:(g-C)/2,letterBoxedHeight:k,letterBoxedWidth:C,letterBoxAspectRatio:C/k,verticalOffset:(h-k)/2}},[i,m,n,e,t,_,v,P,y,b,w,S,x])}},179639:function(e,t,n){n.d(t,{Z:()=>y});var i=n(281098),a=n(667294),o=n(20256),s=n(592821),l=n(979904),r=n(869985),d=n(980787),c=n(19585),u=n(399806),p=n(218831),h=n(601686),m=n(785893);class g extends a.PureComponent{constructor(...e){var t,n,i;super(...e),t="startAudiblePlayTime",n=this.props.muted?null:new Date,(t="symbol"==typeof(i=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?i:i+"")in this?Object.defineProperty(this,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[t]=n}componentDidUpdate(e){e.muted!==this.props.muted&&(this.startAudiblePlayTime=this.props.muted?null:new Date)}componentWillUnmount(){let{musicRecordingId:e,muted:t,pinId:n,video:i}=this.props;if(e&&!t&&this.startAudiblePlayTime&&Date.now()-this.startAudiblePlayTime.getTime()>=2e3){let{hlsv3:t,mp4:a}=(0,u.Z)({vEXP3:i.video_list?.V_EXP3,vEXP4:i.video_list?.V_EXP4,vEXP5:i.video_list?.V_EXP5,vEXP6:i.video_list?.V_EXP6,vEXP7:i.video_list?.V_EXP7,v720P:i.video_list?.V_720P,vHLSV3MOBILE:i.video_list?.V_HLSV3_MOBILE})||{},o=(a||t)?.duration||0;this.props.logContextEvent({event_type:8999,object_id_str:e,aux_data:{pin_id:n,story_pin_music_duration:o}})}}render(){let{activePageIndex:e,aspectRatio:t,blockHeight:n,blockWidth:i,closeupBodyWidth:a,closeupStoryPinViewability:s,closeupWithinMasonryEnabled:l,customEndCard:d,isPlaying:c,muted:p,onEnded:h,onUpdateVideoInfo:g,pageIndex:y,pin:_,pinId:f,maxHeight:b,video:v,videoThumbnailStartTime:x}=this.props,{hlsv3:P,mp4:S}=(0,u.Z)({vEXP3:v.video_list?.V_EXP3,vEXP4:v.video_list?.V_EXP4,vEXP5:v.video_list?.V_EXP5,vEXP6:v.video_list?.V_EXP6,vEXP7:v.video_list?.V_EXP7,v720P:v.video_list?.V_720P,vHLSV3MOBILE:v.video_list?.V_HLSV3_MOBILE})??{},w=S||P;if(!w)return null;let{height:C,thumbnail:k,width:T}=w,I=t??(T??1)/(C??1),j={height:"100%",left:"0",top:"0",width:"100%"},E=l&&a?(a??i)/(Number(b)??n):i/n;if(!l&&Math.abs(E-I)>.01){if(E<I){let e=100*I/E;j.width=`${e}%`,j.left=`-${(e-100)/2}%`}else if(E>I){let e=100*E/I;j.height=`${e}%`,j.top=`-${(e-100)/2}%`}}let A="number"==typeof e&&y<=e+3;return(0,m.jsx)(o.xu,{height:"100%",overflow:"hidden",position:"relative",width:"100%",children:(0,m.jsx)(o.xu,{height:"100%",position:"absolute",width:"100%",children:A||c||x?(0,m.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:j},position:"absolute",children:(0,m.jsx)(r.Z,{aspectRatio:l?E:t,autoplay:c,closeupStoryPinViewability:s,contextLogData:{component:0===y?227:228,element:10957,objectId:f,story_pin_page_id:y,view:3,viewParameter:157},customEndCard:d,customThumbnail:k,isPromoted:!1,loop:!1,muted:p,objectFit:S?l?"contain":"cover":void 0,onEnded:()=>{h&&h(y)},onTimeChange:({time:e})=>{g&&"number"==typeof w.duration&&w.duration>0&&g({currentTime:e,duration:w.duration/1e3})},pinId:f,pinKey:null===_?null:{type:"Legacy",data:_},preferMp4:!!S,showControls:"hover",variant:"storyPin",video:{id:v.id,hlsv3:P,mp4:S},videoThumbnailStartTime:x})}):k&&(0,m.jsx)(o.Ee,{alt:this.props.i18n._('Video cover image', 'closeup.storyPin.videoCover', 'cover image displayed for a video'),fit:"cover",naturalHeight:C??1,naturalWidth:T??1,src:k})})})}}function y(e){(0,a.useEffect)(()=>{(0,i.Z)("StoryPinVideo","/app/common/react/components/closeup/StoryPin/StoryPinVideo.tsx")},[]);let{logContextEvent:t}=(0,d.u)(),{pin:n}=e,o=(0,c.ZP)(),{closeupWithinMasonryEnabled:r}=(0,h.x4)(),{closeupBodyWidth:u}=(0,p.K)(),{maxHeight:y}=(0,s.Re)(),{maxHeight:_}=(0,l.Z)({pinKey:null===n?null:{type:"Legacy",data:n}});return(0,m.jsx)(g,{...e,closeupBodyWidth:u,closeupWithinMasonryEnabled:r,i18n:o,logContextEvent:t,maxHeight:r?_:y})}},248762:function(e,t,n){n.d(t,{Z:()=>Y});var i,a,o=n(281098),s=n(667294);n(167912);var l=n(20256),r=n(112931),d=n(592821),c=n(825332),u=n(883817),p=n(980787),h=n(886981),m=n(785893);let g=({block:{block_style:{height:e=0,width:t=0,x_coord:n=0,y_coord:i=0,rotation:a=0}={},original_comment_id:r},horizontalOffset:g=0,pageAspectRatio:y,scaleFactor:_,verticalOffset:f=0})=>{(0,s.useEffect)(()=>{(0,o.Z)("IdeaPinCommentReplyStickerBlock","/app/common/react/components/closeup/StoryPin/IdeaPinCommentReplyStickerBlock.tsx")},[]);let{logContextEvent:b}=(0,p.u)(),v=d._B/y,x=t*d._B*_/100,P=n*d._B*_/100+g,S=(0,c.s0)(),{data:w}=(0,h.Z)({name:"AggregatedCommentResource",options:{commentId:r,field_set_key:"comment_reply_sticker"}});return(0,m.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:{left:P,top:i*v*_/100+f,transform:`rotate(${a}deg)`}},display:"flex",height:e*v*_/100,margin:-1,padding:1,position:"absolute",rounding:2,width:x,zIndex:u.B_,children:(0,m.jsx)(l.iP,{onTap:()=>{b({event_type:102,view_type:1,component:227,element:12541,aux_data:{comment_id:r}}),w?.pin_id&&S(`/pin/${w.pin_id}/comments/${r||""}`)},rounding:"pill"})})};var y=n(291892),_=n(7525);function f({src:e,fallbackSrc:t,...n}){(0,s.useEffect)(()=>{(0,o.Z)("ImageWithFallback","/app/common/react/components/closeup/StoryPin/renderer/ImageWithFallback.tsx")},[]);let i=(0,_.Z)(e);return(0,m.jsx)(y.Z,{...n,src:i?e:t})}var b=n(581722);function v({isUseCache:e,signature:t}){return(0,b.v9)(({pinbuilder:n})=>{let{storyPinItemBlocks:i}=n;if(!e)return null;for(let e of Object.keys(i))if(i[e].media?.signatureEdited===t||i[e].media?.signature===t)return i[e];return null})}var x=n(111923),P=n(865540),S=n(982166),w=n(19585),C=n(542092);let k=({aggregatedCommentId:e,onDismiss:t})=>{(0,s.useEffect)(()=>{(0,o.Z)("StoryPinQuestionStickerReplyModal","/app/common/react/components/closeup/StoryPin/StoryPinQuestionStickerReplyModal.tsx")},[]);let n=(0,w.ZP)(),i=(0,P.Z)(),a=(0,x.Z)(),[r,d]=(0,s.useState)(""),c=(0,m.jsx)(l.kC,{justifyContent:"end",children:(0,m.jsx)(l.zx,{color:"red",disabled:!r,onClick:()=>{(async()=>{await a({fromUnifiedComment:!0,objectType:C.o.aggregatedComment,objectId:e,tags:"[]",text:r})})(),t()},text:n._('Post', 'ideapin.questionsticker.replymodal.postbutton', 'Post reply to creator Q&A question')})});return(0,m.jsx)(S.ZP,{accessibilityModalLabel:"reply to creator Q and A question",align:"start",footer:c,heading:n._('Reply', 'ideapin.questionsticker.replymodal', 'Reply to creator Q&A question'),onDismiss:t,children:(0,m.jsx)(l.xu,{paddingX:8,paddingY:1,children:(0,m.jsx)(l.Kx,{id:"ideaPinQuestionStickerReplyModalTextArea",onChange:({value:e})=>{d(e)},placeholder:i?n._('Your reply will show up as a public comment on this Pin.', 'pin.questionsticker.replymodal.placeholder', 'Placeholder for creator Q&A reply textarea'):n._('Your reply will show up as a public comment on this Idea Pin.', 'ideapin.questionsticker.replymodal.placeholder', 'Placeholder for creator Q&A reply textarea'),value:r})})})};var T=n(744862),I=n(821342),j=n(28427),E=n(302148),A=n(123317),R=n(294711);let z=(void 0!==i||(i=n(303965)).hash&&"7e8d917850c8329247291df0d281a59b"!==i.hash&&console.error("The definition of 'StoryPinStickerBlockCloseup_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i);function L({block:e,elementType:t,horizontalOffset:n=0,onFlyoutOpen:i,pageAspectRatio:a,pageIndex:r,pinKey:g,scaleFactor:y,tooltipElementType:_,verticalOffset:f=0,videoPinProgress:b}){(0,s.useEffect)(()=>{(0,o.Z)("StoryPinStickerBlock","/app/common/react/components/closeup/StoryPin/StoryPinStickerBlock.tsx")},[]);let{logContextEvent:v}=(0,p.u)(),[x,P]=(0,s.useState)(!1),[S,C]=(0,s.useState)(!1),L=(0,s.useRef)(null),V=(0,c.s0)(),M=(0,w.ZP)(),Z=(0,j.Z)(z,g),F=(0,I.Z)(),{block_style:{height:O=0,width:N=0,x_coord:B=0,y_coord:D=0,rotation:W=0}={},end_time:$,error_message:H,interactive_sticker_type:K=null,is_removed:U,is_valid:G,start_time:X,sticker_data:q,type:J}=e,Y=Z?.entityId,{board_id:Q,question_comment_id:ee}=q||{},{image_small_url:et,full_name:en,username:ei=""}=e.user??{},ea=null,eo=G&&5===K&&!!Q,es=G&&7===K&&!!ee,el=(0,h.Z)(Q&&eo?{name:"BoardResource",options:{field_set_key:"tagged_board_preview",board_id:Q}}:null),{is_collaborative:er,pin_count:ed,url:ec}=el.data||{};J===A.h8.PRODUCT_STICKER?ea=Y?`/pin/${Y}/`:"/":J===A.h8.MENTION_STICKER?ea=`/${ei}/`:eo&&(ea=el.isLoaded?`${ec}`:null);let eu=d._B/a,ep=N*d._B*y/100,eh=B*d._B*y/100+n,{currentTime:em}=b||{},eg=!(0,R.Z)({currentTime:em,endTime:$,startTime:X}),ey=()=>{v({event_type:123,component:228,element:_,view_type:3,view_parameter:157,aux_data:{story_pin_page_id:r}}),P(!1)};(0,s.useEffect)(()=>(document.addEventListener("scroll",()=>{P(!1)}),()=>document.removeEventListener("scroll",()=>{P(!1)})),[]);let e_=()=>{let e=null,t=F.isAuth?F?.avatar_color_index:void 0;switch(J){case A.h8.PRODUCT_STICKER:let{gridTitle:n,imageSpec_236x:i,richSummary:a,description:o}=Z||{},{displayName:r,products:d}=a||{},c=((d||[])[0]||{}).offerSummary||{},{price:u,maxPrice:p}=c||{},h=!!c&&(!!u||!!p),g=r||n||o;e=(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(l.xu,{flex:"none",children:(0,m.jsx)(l.zd,{height:40,rounding:3,wash:!0,width:40,children:i?.url&&(0,m.jsx)(l.Ee,{alt:"",color:"lightGray",fit:"cover",naturalHeight:1,naturalWidth:1,src:i.url})})}),(0,m.jsx)(l.xu,{flex:"grow",paddingX:2,children:h?(0,m.jsxs)(l.kC,{alignContent:"center",alignItems:"stretch",direction:"column",flex:"grow",justifyContent:"center",children:[(0,m.jsx)(l.xv,{color:"shopping",lineClamp:1,size:"100",weight:"bold",children:u}),(0,m.jsx)(l.xv,{lineClamp:1,size:"100",children:g})]}):(0,m.jsx)(l.xv,{lineClamp:1,size:"100",children:g})}),(0,m.jsx)(l.xu,{flex:"none",children:(0,m.jsx)(l.Sj,{bgColor:"transparent",icon:"arrow-forward",iconColor:"darkGray",size:"xs"})})]});break;case A.h8.MENTION_STICKER:e=(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(l.xu,{flex:"none",children:(0,m.jsx)(T.qE,{color:t,name:en??"",size:"sm",src:et??void 0})}),(0,m.jsx)(l.xu,{flex:"grow",paddingX:2,children:(0,m.jsx)(l.xv,{lineClamp:1,size:"200",weight:"bold",children:en})}),(0,m.jsx)(l.xu,{flex:"none",children:(0,m.jsx)(l.Sj,{bgColor:"transparent",icon:"arrow-forward",iconColor:"darkGray",size:"xs"})})]});break;case A.h8.GENERIC_STICKER:e=[5].includes(K)?G?el.isLoaded?(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)(l.xu,{flex:"grow",paddingX:2,children:[(0,m.jsx)(l.xv,{lineClamp:1,size:"100",weight:"bold",children:er?M._('Explore this group board', 'closeup.StoryPin.stickerBlock.boardSticker.clickLabel', 'Label explaining click action when group board tag flyout showing'):M._('Explore this board', 'closeup.StoryPin.stickerBlock.boardSticker.clickLabel', 'Label explaining click action when board tag flyout showing')}),(0,m.jsx)(l.xv,{size:"100",children:(!!ed||0===ed)&&(0,E.nk)(M.ngettext('{{ pinCount }} Pin', '{{ pinCount }} Pins', ed, 'closeup.StoryPin.stickerBlock.boardSticker.boardLabel', 'Caption when board tag flyout that showing number of Pins on board'),{pinCount:ed})})]}),(0,m.jsx)(l.xu,{flex:"none",children:(0,m.jsx)(l.Sj,{bgColor:"transparent",icon:"arrow-forward",iconColor:"darkGray",size:"xs"})})]}):(0,m.jsxs)(l.xu,{alignItems:"center",direction:"row",display:"flex",flex:"grow",paddingY:2,children:[(0,m.jsx)(l.xu,{marginEnd:1,paddingX:2,children:(0,m.jsx)(l.xv,{color:"subtle",lineClamp:1,size:"100",children:M._('Loading board...', 'closeup.StoryPin.stickerBlock.boardSticker.loadingText', 'Label explaining board sticker still loading')})}),(0,m.jsx)(l.xH,{accessibilityLabel:M._('Board is loading', 'closeup.StoryPin.stickerBlock.boardSticker.loadingSpinnerText', 'Accessibility label for board loading spinner'),show:!0,size:"sm"})]}):(0,m.jsx)(l.xu,{paddingX:2,paddingY:2,children:(0,m.jsx)(l.xv,{color:"subtle",lineClamp:1,size:"200",weight:"bold",children:H})}):(0,m.jsx)(l.xu,{paddingX:2,paddingY:2,children:(0,m.jsx)(l.xv,{color:"subtle",lineClamp:1,size:"200",weight:"bold",children:M._('Sticker not supported yet', 'closeup.StoryPin.stickerBlock.genericStickerError', 'Label explaining this sticker has not been implemented yet')})});break;case A.h8.VTO_MAKEUP_STICKER:e=(0,m.jsx)(l.xv,{size:"300",weight:"bold",children:M._('Try this sticker on your phone!', 'closeup.storyPin.vtoMakeupSticker', 'Caption when @vitural-try-on-makeup tag is tapped for Web')})}return(0,m.jsx)(l.xu,{alignItems:"center","data-test-id":J,display:"flex",justifyContent:"center",padding:J===A.h8.PRODUCT_STICKER?1:3,width:"100%",children:U?(0,m.jsx)(l.xv,{color:"subtle",size:"200",weight:"bold",children:M._('Tag removed!', 'closeup.storyPin.stickerBlock', 'Caption when the tag is removed')}):e})};return(0,m.jsx)(s.Fragment,{children:eg?null:(0,m.jsxs)(l.xu,{ref:L,dangerouslySetInlineStyle:{__style:{left:eh,top:D*eu*y/100+f,transform:`rotate(${W}deg)`}},"data-test-id":(J||"")+"_container",display:"flex",height:O*eu*y/100+2*d.Xw,margin:-1,padding:1,position:"absolute",rounding:2,width:ep+2*d.Xw,zIndex:u.B_,children:[(0,m.jsx)(l.iP,{disabled:eg,onTap:x?ey:({event:e})=>{eg||(v({event_type:101,component:228,element:t,view_type:3,view_parameter:157,aux_data:{story_pin_page_id:r}}),es?C(!0):(({event:e})=>{v({event_type:120,component:228,element:_,view_type:3,view_parameter:157,aux_data:{error_message:!G&&H?H:null,story_pin_page_id:r}}),P(!0),i&&(e.stopPropagation(),i())})({event:e}))},rounding:"pill"}),x&&(0,m.jsx)(l.mh,{zIndex:u.ej,children:(0,m.jsx)(l.J2,{_deprecatedShowCaret:!0,anchor:L.current,idealDirection:"up",onDismiss:ey,positionRelativeToAnchor:!1,size:U?"flexible":"sm",children:U?e_():(0,m.jsx)(l.iP,{fullWidth:!0,onTap:({event:e})=>{e.preventDefault(),U||(v({event_type:101,component:228,element:_,object_id_str:Y,view_type:3,view_parameter:157,aux_data:{story_pin_page_id:r}}),ea?V(ea):ey())},children:e_()})})}),!!ee&&S&&(0,m.jsx)(k,{aggregatedCommentId:ee,onDismiss:()=>{C(!1)}})]})})}var V=n(445698),M=n(47676),Z=n(238187),F=n(452750);function O({block:e,fontsLoaded:t,horizontalOffset:n=0,pageAspectRatio:i,scaleFactor:a,thumbnail:r,verticalOffset:d=0}){(0,s.useEffect)(()=>{(0,o.Z)("StoryPinTextBlock","/app/common/react/components/closeup/StoryPin/StoryPinTextBlock.tsx")},[]);let{block_style:c,style:u=A.Cc,text:p}=e,{alignment:h,font:g,font_size:y,highlight_color:_,vertical_alignment:f=A.Cc.vertical_alignment}=u,{hex_color:b=A.Cc.hex_color}=u??{},[v,x]=(0,s.useState)(0),[P,S]=(0,s.useState)([]),w=g||A.Cc.font,{name:C,default_size:k,letter_spacing:T,line_height:I}=w,j=(0,F.Z)(w),E=Math.round(100*(c?.width||100))/1e4,R=Math.round(100*(c?.height||100))/1e4,z=Math.round(100*(c?.x_coord||0))/1e4,L=Math.round(100*(c?.y_coord||0))/1e4;(0,s.useEffect)(()=>{if(t){let e=(0,Z.KV)({text:p,boxHeight:M.q8/i*R,boxWidth:M.q8*E,font:j,startFontSize:Math.floor(y||k||24)});S(e.lines),x(e.fontSize)}},[t,p]);let O=v*a,N=_?(0,A.pE)(O,I):{x:0,y:0},B=E*M.q8*a+2*N.x,D=R*(M.q8/i)*a+2*N.y,W=n+z*M.q8*a-N.x,$=r?`${100*L}%`:d+L*(M.q8/i)*a-N.y;return(0,m.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:{left:W,top:$}},display:"flex",height:D,position:"absolute",width:B,children:(0,m.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:(0,V.RK)({alignment:h,verticalAlignment:f})},children:(0,m.jsx)(l.xu,{display:"inlineBlock",maxWidth:"100%",children:(0,m.jsx)("p",{style:(0,V.BN)({fontSize:O,hexColor:b,letterSpacing:T,lineHeight:I,name:C}),children:P.map((e,t)=>(0,m.jsx)("span",{"data-gestalt-valid-html":"Text",style:(0,V.xm)({fontSize:O,hasText:e.text.length>0,highlightColor:_||null,lineHeight:I}),children:t===P.length-1?e.text:(0,m.jsxs)(s.Fragment,{children:[e.text," ",(0,m.jsx)("br",{})]})},`paragraphLine-${t}-${(p??"").substr(0,9)}`))})})})})}var N=n(179639);function B({ownerId:e}){(0,s.useEffect)(()=>{(0,o.Z)("StoryPinVideoPlaceholder","/app/common/react/components/closeup/StoryPin/StoryPinVideoPlaceholder.tsx")},[]);let t=(0,w.ZP)(),n=(0,I.Z)(),i=n.isAuth&&n.id===e;return(0,m.jsxs)(l.xu,{alignItems:"center",color:"tertiary",direction:"column",display:"flex",height:"100%",justifyContent:"center",width:"100%",children:[(0,m.jsx)(l.xv,{color:"inverse",children:i?t._('Your video is processing!', 'closeup.storyPin.videoPlaceholder', 'Let user know that their video is still processing'):t._('This video is still processing!', 'closeup.storyPin.videoPlaceholder', 'Let user know that this video is still processing')}),(0,m.jsx)(l.xv,{color:"inverse",children:t._('Check back in a few minutes.', 'closeup.storyPin.videoPlaceholder', 'Let user know to come back in a couple of minutes to view the video')})]})}var D=n(139707),W=n(934645),$=n(716920),H=n(956077),K=n(85574),U=n(601686),G=n(653621);function X({block:e,isActive:t,pwtTrackImageLoad:n,thumbnail:i}){let a,o=(0,w.ZP)(),{closeupWithinMasonryEnabled:s,isCloseupMediaViewerOpen:c,peekCloseupEnabled:u,showProductDetailPage:p}=(0,U.x4)(),h=(0,W.Z)({showProductDetailPage:p}),{borderStyle:g}=i||h?{}:(0,K.Z)({closeupWithinMasonryEnabled:s}),_=e.image?.images?.["750x"]||e.image?.images?.["474x"],{height:b=1,width:x=1}=_||{},P=v({isUseCache:!0,signature:e.image_signature}),{peekRedesignFastFollowsEnabled:S}=(0,D.Z)(_);return _||P?(a=i?"cover":s||S?"none":"contain",(0,m.jsx)(l.xu,{alignItems:u?"center":void 0,dangerouslySetInlineStyle:{__style:{...g,aspectRatio:s?(0,r.GJ)(x,b):void 0,contain:"strict",display:u?"grid":"block",justifySelf:s?"center":void 0}},height:s?"100%":"inherit",overflow:"hidden",width:s?void 0:"inherit",children:P?(0,m.jsx)(f,{_enableViewTransitions:!0,alt:o._('Story pin image', 'closeup.storypin.renderer', 'Alt text for story pin image'),color:d.yc,elementTiming:"StoryPinImageBlock-MainPinImage",fallbackSrc:P.media?.src??"",fit:a,isActive:t,naturalHeight:b,naturalWidth:x,onLoad:n,src:_?.url??"",suppressViewTransitionTags:c}):(0,m.jsx)(y.Z,{_enableViewTransitions:!0,alt:o._('Story pin image', 'closeup.storypin.renderer', 'Alt text for story pin image'),borderStyle:g,color:d.yc,elementTiming:"StoryPinImageBlock-MainPinImage",fetchPriority:s?"high":void 0,fit:a,isActive:t,naturalHeight:_?.height??1,naturalWidth:_?.width??1,onLoad:n,src:_?.url??"",suppressViewTransitionTags:c})})):null}function q({activePageIndex:e,block:t,closeupStoryPinViewability:n,customEndCard:i,isActive:a,isSplitLayout:o=!1,musicRecordingId:s,muted:r,onEnded:c,onUpdateVideoInfo:u,ownerId:p,pageAspectRatio:h,pageDimensions:g,pageIndex:y,pin:_,pinId:f,scaleFactor:b,stillLoading:x,videoThumbnailStartTime:P,thumbnail:S=!1}){let{block_style:{height:w=100,width:C=100,x_coord:k=0,y_coord:T=0}={},video:I}=t,{closeupWithinMasonryEnabled:j}=(0,U.x4)(),E=d._B/h,{height:A,width:R}=g,z=C*d._B*b/100,L=C<100?Math.min(Math.max(100,C)-Math.abs(k),C):Math.min(Math.max(C-Math.abs(k),0),100),V=w<100?Math.min(Math.max(100,w)-Math.abs(T),w):Math.min(Math.max(w-Math.abs(T),0),100),M=j?"100%":V*E*b/100,Z=j?"100%":L*d._B*b/100,F=Math.max(T,0)*E*b/100,O=Math.max(k,0)*d._B*b/100,D=v({isUseCache:!I,signature:t.video_signature});if(x)return null;let{media:W}=D||{},{duration:$,src:H}=W||{},K=!!H&&!!$;return I||K?!!(I?.video_list?.V_HLSV3_MOBILE||I?.video_list?.V_720P||K)&&(0,m.jsx)(l.xu,{height:o?"50%":"100%",overflow:"hidden",position:"relative",children:(0,m.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:{alignSelf:"anchor-center",left:O,top:F}},"data-test-id":"story-pin-video-block",height:S?A:M,overflow:"hidden",position:"absolute",width:S?R:Z,children:(0,m.jsx)(N.Z,{activePageIndex:e,aspectRatio:h,blockHeight:S?A:w*E*b/100,blockWidth:S?R:z,closeupStoryPinViewability:n,customEndCard:i,isPlaying:a,musicRecordingId:s,muted:r,onEnded:c,onUpdateVideoInfo:u,pageIndex:y,pin:_,pinId:f,video:I||{video_list:{V_EXP7:{duration:$?1e3*$:0,url:H}}},videoThumbnailStartTime:P})})}):(0,m.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:{left:O,top:F}},height:M,position:"absolute",width:Z,children:(0,m.jsx)(B,{ownerId:p})})}let J=(void 0!==a||(a=n(35312)).hash&&"8bb1bb1f7bafeed0fe43bed44ef12d2a"!==a.hash&&console.error("The definition of 'StoryPinBlock_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),a);function Y({activePageIndex:e,block:t,closeupStoryPinViewability:n,customEndCard:i,disableProductStickers:a,fontsLoaded:r,horizontalOffset:c,isActive:u,isSplitLayout:p=!1,musicRecordingId:h,muteVideos:y,onEnded:_,onFlyoutOpen:f,onUpdateVideoInfo:b,ownerId:v,pageAspectRatio:x,pageHeight:P,pageIndex:S,pageWidth:w,pin:C,pinId:k,previewOnly:T,pinKey:I,stillLoading:E=!1,thumbnail:R=!1,transform:z,verticalOffset:V,videoPinProgress:M,videoThumbnailStartTime:Z}){(0,s.useEffect)(()=>{(0,o.Z)("StoryPinBlock","/app/common/react/components/closeup/StoryPin/renderer/StoryPinBlock.tsx")},[]);let F=(0,j.Z)(J,I),{closeupWithinMasonryEnabled:N}=(0,U.x4)(),{block_style:{height:B=100,width:D=100,x_coord:W=0,y_coord:K=0}={},interactive_sticker_type:Y=null}=t,Q=(0,$.g)();if(0===B||0===D)return null;let ee=w/d._B;switch(t.type){case A.h8.PARAGRAPH:case A.h8.HEADING:return(0,m.jsx)(O,{block:t,fontsLoaded:r,horizontalOffset:c,pageAspectRatio:x,scaleFactor:ee,thumbnail:R,verticalOffset:V});case A.h8.VIDEO:return(0,m.jsx)(q,{activePageIndex:e,block:t,closeupStoryPinViewability:n,customEndCard:i,isActive:u,isSplitLayout:p,musicRecordingId:h,muted:y,onEnded:_,onUpdateVideoInfo:b,ownerId:v,pageAspectRatio:x,pageDimensions:{height:P,width:w},pageIndex:S,pin:C,pinId:k,scaleFactor:ee,stillLoading:E,thumbnail:R,videoThumbnailStartTime:Z});case A.h8.IMAGE:let{scaleX:et=1,scaleY:en=1}=z||{};return(0,m.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:{display:N?"grid":"block",height:`${B}%`,left:`${W*et}%`,top:`${K*en}%`,width:`${D}%`}},"data-test-id":"story-pin-image-block",overflow:"hidden",position:"absolute",children:(0,m.jsx)(X,{block:t,isActive:u,pwtTrackImageLoad:()=>{Q&&u&&(Q.addBinaryAnnotation("pin.id",k,"STRING"),Q.addBinaryAnnotation("video",!1,"BOOL"),Q.stop()),u&&((0,H.rt)("pin.id",k,"STRING"),(0,H.rt)("video",!1,"BOOL"),(0,H.Nx)(G.pM),(0,H.l7)(G._z))},thumbnail:R})});case A.h8.MENTION_STICKER:return!T&&(0,m.jsx)(L,{block:{...t},elementType:12120,horizontalOffset:c,onFlyoutOpen:f,pageAspectRatio:x,pageIndex:S,pinKey:null,scaleFactor:ee,tooltipElementType:12121,verticalOffset:V,videoPinProgress:M});case A.h8.GENERIC_STICKER:return!T&&(e=>{let t=5===Y;return(0,m.jsx)(L,{block:{...e},elementType:t?12827:12858,horizontalOffset:c,onFlyoutOpen:f,pageAspectRatio:x,pageIndex:S,pinKey:null,scaleFactor:ee,tooltipElementType:t?12828:12859,verticalOffset:V,videoPinProgress:M})})(t);case A.h8.PRODUCT_STICKER:return!T&&!a&&(0,m.jsx)(L,{block:{...t},elementType:12223,horizontalOffset:c,onFlyoutOpen:f,pageAspectRatio:x,pageIndex:S,pinKey:F,scaleFactor:ee,tooltipElementType:12224,verticalOffset:V,videoPinProgress:M});case A.h8.VTO_MAKEUP_STICKER:return!T&&(0,m.jsx)(L,{block:{...t},elementType:12561,horizontalOffset:c,onFlyoutOpen:f,pageAspectRatio:x,pageIndex:S,pinKey:null,scaleFactor:ee,tooltipElementType:12561,verticalOffset:V,videoPinProgress:M});case A.h8.COMMENT_REPLY_STICKER:return t.type===A.h8.COMMENT_REPLY_STICKER&&!T&&(0,m.jsx)(g,{block:t,horizontalOffset:c,pageAspectRatio:x,scaleFactor:ee,verticalOffset:V});default:return null}}},979904:function(e,t,n){n.d(t,{Z:()=>h});var i,a=n(667294);n(422578);var o=n(995415),s=n(934645),l=n(28427),r=n(906498),d=n(644493),c=n(664897),u=n(601686);let p=(void 0!==i||(i=n(331047)).hash&&"b2a27d44d1f3dbd42301b82866212272"!==i.hash&&console.error("The definition of 'useCalculateMaxWidthAndHeightForSideBySideVariant_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i);function h({pinKey:e}){let{closeupWithinMasonryEnabled:t}=(0,u.x4)(),n=(0,c.Z)(),i=(0,l.Z)(p,e),h=(0,s.Z)({showProductDetailPage:!!i?.isEligibleForPdp}),{group:m}=(0,r.Z)(),g=(0,a.useMemo)(()=>i?.carouselData?{carouselSlots:i.carouselData.carouselSlots?.map(e=>({domain:e.domain,link:e.link}))||[],index:i.carouselData.index}:void 0,[i?.carouselData]),{currentDomain:y}=(0,a.useMemo)(()=>(0,o.Z)({carouselData:g,domain:i?.domain}),[g,i?.domain]),_=(0,a.useMemo)(()=>y?y.split(".")[0]:"",[y]),f=(0,a.useMemo)(()=>{let e=i?.trackedLink||i?.link||"";return(0,d.Z)(e)??e},[i?.trackedLink,i?.link]),b=(0,a.useMemo)(()=>{let e=i?.richMetadata?.products?.[0],t=e?.offerSummary,n=!!(t?.price||t?.standardPrice),a=i?.linkDomain?.officialUser?.firstName;return{hasPrice:n,domainOwner:!!i?.closeupAttribution?.firstName||!!a,merchantName:i?.linkUserWebsite?.officialUser?.firstName||a||""}},[i?.richMetadata?.products,i?.linkDomain?.officialUser?.firstName,i?.closeupAttribution?.firstName,i?.linkUserWebsite?.officialUser?.firstName]),v=(0,a.useMemo)(()=>!!((b.merchantName||_)&&f),[b.merchantName,_,f]),x=(0,a.useMemo)(()=>{let e,t=0,n=0;return e=84+(i?.isEligibleForPdp&&b.hasPrice?18:0),t+=(i?.closeupUnifiedTitle||i?.gridTitle?23:0)+("enabled_idea_pin"!==m&&b.domainOwner?40:0),n+=64*!!v,e+=Math.max(t,n)},[i?.isEligibleForPdp,b.hasPrice,i?.closeupUnifiedTitle,i?.gridTitle,m,b.domainOwner,v]);if(!t)return{maxHeight:void 0};if(n)return{maxHeight:h?void 0:`calc(round(100vh, 1px) - 80px - ${x}px)`};let P=Math.round(window.innerHeight)-80-x;return{maxHeight:h?void 0:P}}},11919:function(e,t,n){n.r(t),n.d(t,{default:()=>T});var i=n(281098),a=n(667294),o=n(303151),s=n(20256),l=n(707915),r=n(856782),d=n(111330),c=n(702849),u=n(19585),p=n(369416),h=n(753143),m=n(341742),g=n(664897),y=n(790427),_=n(785893);function f({containerRef:e,onAnimationEnd:t,startAnimating:n,containerWidth:i}){let o=(0,u.ZP)(),l=(0,g.Z)(),r=(0,h.M0)(),[m,f]=(0,a.useState)(),[b,v]=(0,a.useState)(!1),[x,P]=(0,a.useState)(),S=o._('Share', 'secondarySendButtonAnimation.share', 'Share label for sharing a Pin'),w={buttonStyle:{animation:m,backgroundColor:c.Et},textStyle:{animation:x}};return(0,a.useEffect)(()=>{if(!l&&i)if(n){v(!0);let{animationSeenCount:e}=r.getItem(d.$M)||{animationSeenCount:0};r.setItem(d.$M,{animationSeenCount:e+1,lastAnimationTimestamp:Date.now()}),f("buttonSlideOut 1s ease-in forwards"),P("textFadeIn 1s ease-in forwards")}else f("buttonSlideIn .3s ease-in forwards"),P("textFadeOut .3s ease-in-out forwards")},[i,r,n,l]),(0,_.jsxs)(a.Fragment,{children:[(0,_.jsx)(p.Z,{unsafeCSS:`
@keyframes buttonSlideOut {
  0% {
    width: 48px;
  }
  15% {
    width: ${i}px;
  }
  100% {
    width: ${i}px;
  }
}

@keyframes textFadeIn {
  0% {
    opacity: 0;
  }
  15% {
    opacity: 0;
  }
  25% {
    opacity: 1;
  }
  100% {
    opacity: 1;
  }
}

@keyframes buttonSlideIn {
  0% {
    width: ${i}px;
  }
  100% {
    width: 48px;
  }
}

@keyframes textFadeOut {
  0% {
    opacity: 1;
  }
  15% {
    opacity: 1;
  }
  25% {
    opacity: 0;
  }
  100% {
    opacity: 0;
  }
}
`}),(0,_.jsx)(s.xu,{ref:e,alignItems:"center",dangerouslySetInlineStyle:{__style:{...w.buttonStyle,visibility:b?"visible":"hidden"}},display:"flex",onAnimationEnd:e=>{"buttonSlideIn"===e.animationName&&t()},position:"absolute",rounding:4,zIndex:y.mS,children:(0,_.jsxs)(s.kC,{alignItems:"center",gap:1,children:[(0,_.jsx)(s.xu,{padding:3,children:(0,_.jsx)(s.JO,{accessibilityLabel:S,color:"default",icon:"share",size:24})}),(0,_.jsx)(s.xu,{dangerouslySetInlineStyle:{__style:w.textStyle},marginEnd:3,children:(0,_.jsx)(s.mg,{size:"md",children:S})})]})})]})}function b({onAnimationEnd:e}){(0,a.useEffect)(()=>{(0,i.Z)("SecondarySendButtonAnimation","/app/common/react/components/social/SecondarySendButtonAnimation.tsx")},[]);let t=(0,a.useRef)(null),[n,o]=(0,a.useState)(0),[s,l]=(0,a.useState)(!1);return(0,m.Z)(()=>{let e=setTimeout(()=>{l(!0);let e=setTimeout(()=>{l(!1)},3e3);return()=>clearTimeout(e)},r.S+1e3);return()=>clearTimeout(e)}),(0,a.useEffect)(()=>{if(t.current&&!n&&s){let e=t.current.getBoundingClientRect().width;e&&o(e)}},[t,n,s]),(0,_.jsx)(f,{containerRef:t,containerWidth:n,onAnimationEnd:e,startAnimating:s})}var v=n(121836),x=n(721214),P=n(675973),S=n(238589),w=n(807765),C=n(74229),k=n(539532);function T({controllerOptions:e,iconColor:t,iconOnly:n,buttonText:r,showSendAnimation:c=!1,tabIndex:p=0,closeupWithinMasonryEnabled:g=!1,isInCloseupMediaViewer:y=!1}){(0,a.useEffect)(()=>{(0,i.Z)("SecondarySendButton","/app/common/react/components/social/SecondarySendButton.tsx")},[]);let f=(0,u.ZP)(),T=(0,h.M0)(),I=(0,S.Nl)(),{checkExperiment:j}=(0,P.Z)(),{setIsShowingShareButton:E}=(0,w.f)(),A=(0,a.useRef)(null),[R,z]=(0,a.useState)(c),L=y?new s.H3([C.k]):new s.Ry(5),[V]=(0,a.useState)(()=>{let e=I.getItem(v.bl)||0,{animationSeenCount:t}=T.getItem(d.$M)||{animationSeenCount:0};return t<2&&(2===e||3===e)}),M=()=>{z(!1)};return(0,m.Z)(()=>{let{lastAnimationTimestamp:e}=T.getItem(d.$M)||{lastAnimationTimestamp:0};(0,o.Z)(new Date(e),new Date)||T.setItem(d.$M,{animationSeenCount:0,lastAnimationTimestamp:e})}),(0,a.useEffect)(()=>(E(c),()=>{E(!1)}),[E,c]),(0,_.jsxs)(a.Fragment,{children:[(0,_.jsx)(k.Z,{...e,children:({handleSendShareFlyoutButtonClick:i})=>(0,_.jsxs)(s.u,{inline:!0,text:f._('Share', 'Closeup.SharePin.Icon', 'Icon for sharing the current pin'),zIndex:L,children:[R&&V&&j("sg_dweb_improved_share_animation_on_closeup").anyEnabled&&(0,_.jsx)(s.xu,{"data-test-id":"closeup-share-button",children:(0,_.jsx)(s.iP,{onTap:i,children:(0,_.jsx)(b,{onAnimationEnd:M})})}),y?(0,_.jsx)(s.zx,{ref:A,accessibilityLabel:f._('Share', 'Closeup.SharePin.AccessibilityLabel', 'Accessible label for button to share this pin'),color:"semiTransparentWhite",iconEnd:"share",onClick:i,size:"lg",tabIndex:p,text:(0,_.jsx)(s.xv,{weight:"bold",children:f._('Share', 'Closeup.SharePin.Button', 'Button to share the current pin')})}):(0,_.jsx)(l.Z,{ref:A,accessibilityLabel:f._('Send', 'Accessible label for button to send this pin', 'Accessible label for button to send this pin'),bgColor:g?"white":void 0,buttonText:r,handleClick:()=>i(),icon:"share",iconColor:t,iconOnly:n,isActive:e.isFlyoutOpen,tabIndex:p,testId:"closeup-share-button"})]})}),(0,_.jsx)(x.N,{anchors:{3017:A.current},idealDirection:"down",onAnchorTouch:"complete",placementId:12,scrollToDismiss:!0})]})}},869985:function(e,t,n){n.d(t,{Z:()=>U});var i,a,o=n(281098),s=n(667294);n(422578);var l=n(20256),r=n(592821),d=n(979904),c=n(890479),u=n(11919),p=n(980787),h=n(679422),m=n(28427),g=n(19585),y=n(601686),_=n(603316),f=n(785893);function b(e,t,n){var i;return(t="symbol"==typeof(i=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?i:i+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let v={__style:{backgroundColor:"#000"}},x=(void 0!==i||(i=n(307595)).hash&&"e04be51b4be0a2585e7803d004fa83b7"!==i.hash&&console.error("The definition of 'CloseupVideoEndCard_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i);class P extends s.PureComponent{constructor(...e){super(...e),b(this,"handleRestartVideo",({event:e})=>{e.stopPropagation(),this.props.onRestartVideo?.({event:e}),(0,_.nP)("web.video.endcard.share",{sampleRate:1,tags:{status:"restart",variant:"enabled_send_first"}})}),b(this,"handleShareVideo",()=>{let{clientTrackingParams:e,onToggleFlyout:t,isFlyoutOpen:n,pinId:i,requireAuth:a,logContextEvent:o}=this.props;if(n&&(0,_.nP)("web.video.endcard.share",{sampleRate:1,tags:{status:"shareSheetOpen",variant:"enabled_send_first"}}),o({event_type:101,component:179,object_id_str:i,view_type:3,view_parameter:156,element:11731,clientTrackingParams:e}),a)return void a();t&&t()}),b(this,"handleExternalSend",()=>{(0,_.nP)("web.video.endcard.share",{sampleRate:1,tags:{status:"shareSheetOpen",variant:"enabled_send_first"}})}),b(this,"renderReplayButton",()=>(0,f.jsx)(l.iP,{accessibilityLabel:this.props.i18n._('Watch again', 'Button when pressed restarts the video', 'Button when pressed restarts the video'),onTap:this.handleRestartVideo,rounding:2,children:(0,f.jsxs)(l.xu,{alignItems:"center",display:"flex",padding:2,children:[(0,f.jsx)(l.xu,{marginEnd:3,children:(0,f.jsx)(l.JO,{accessibilityLabel:this.props.i18n._('Watch again', 'Button when pressed restarts the video', 'Button when pressed restarts the video'),color:"inverse",icon:"refresh",size:18})}),(0,f.jsx)(l.X6,{color:"light",overflow:"normal",size:"400",children:this.props.i18n._('Watch again', 'Clickable label when pressed restarts the video', 'Clickable label when pressed restarts the video')})]})})),b(this,"renderShareButton",()=>{let{clientTrackingParams:e,gridDescription:t,imageSrc:n,isFlyoutOpen:i,onFlyoutDismiss:a,pinId:o}=this.props;return(0,f.jsx)(l.iP,{accessibilityLabel:this.props.i18n._('Send', 'end.video.send.icon.label', 'Clickable label when pressed opens share sheet after video is finished'),onTap:this.handleShareVideo,rounding:2,children:(0,f.jsxs)(l.xu,{alignItems:"center",display:"flex",justifyContent:"center",padding:2,children:[(0,f.jsx)(u.default,{controllerOptions:{flyoutDisplayOptions:{shownWithinMasonry:!0},loggingOptions:{component:179,element:72,onExternalSend:this.handleExternalSend,viewType:3},isFlyoutOpen:i,onFlyoutDismiss:a,onToggleFlyout:()=>{},sendObject:{type:"pin",description:t,id:o,imageUrl:n,url:`/pin/${o}/`,clientTrackingParams:e}},iconColor:"white",iconOnly:!0,tabIndex:-1}),(0,f.jsx)(l.xu,{children:(0,f.jsx)(l.X6,{color:"light",overflow:"normal",size:"400",children:this.props.i18n._('Send', 'end.video.send.icon.label', 'Clickable label when pressed opens share sheet after video is finished')})})]})})})}componentDidMount(){let{clientTrackingParams:e,pinId:t,logContextEvent:n}=this.props;(0,_.nP)("web.video.endcard.share",{sampleRate:1,tags:{status:"land",variant:"enabled_send_first"}}),n({event_type:13,component:179,object_id_str:t,view_type:3,view_parameter:156,element:11731,clientTrackingParams:e})}render(){let{backgroundImage:e,naturalHeight:t,naturalWidth:n,maxHeight:i,maxWidth:a,pinTitle:o}=this.props;return(0,f.jsx)(l.xu,{maxHeight:i,maxWidth:a,children:(0,f.jsxs)(l.Ee,{alt:o||"",naturalHeight:t,naturalWidth:n,src:e,children:[(0,f.jsx)(l.xu,{bottom:!0,dangerouslySetInlineStyle:v,left:!0,position:"absolute",right:!0,top:!0}),(0,f.jsx)(l.xu,{alignItems:"center",direction:"column",display:"flex",height:"100%",justifyContent:"center",left:!0,maxHeight:i,maxWidth:a,position:"absolute",top:!0,width:"100%",children:(0,f.jsxs)(l.xu,{position:"absolute",children:[(0,f.jsx)(l.xu,{children:this.renderShareButton()}),(0,f.jsx)(l.xu,{alignSelf:"center",children:this.renderReplayButton()})]})})]})})}}function S(e){let t;(0,s.useEffect)(()=>{(0,o.Z)("CloseupVideoEndCard","/app/common/react/components/video/closeup/CloseupVideoEndCard.tsx")},[]);let{pinKey:n,variant:i}=e,a=(0,m.Z)(x,n),{logContextEvent:l}=(0,p.u)(),c=(0,g.ZP)(),u=(0,h.Z)(),{closeupWithinMasonryEnabled:_,peekCloseupEnabled:b,viewportSize:v}=(0,y.x4)(),{maxHeight:S,fiftyPercentHeight:w,fiftyPercentWidth:C}=(0,r.Re)(),{maxHeight:k}=(0,d.Z)({pinKey:a});return b?t="sm"===v?w:S:_&&(t=k),(0,f.jsx)(P,{...e,closeupWithinMasonryEnabled:_,i18n:c,logContextEvent:l,maxHeight:"media-viewer"===i?"inherit":t,maxWidth:"media-viewer"===i?"inherit":C,requireAuth:u})}let w=({backgroundImage:e,onRestartVideo:t,pinTitle:n})=>{(0,s.useEffect)(()=>{(0,o.Z)("CloseupVideoEndCard","/app/common/react/components/video/closeup/CloseupVideoEndCard.tsx")},[]);let i=(0,g.ZP)();return(0,f.jsx)(l.xu,{"data-test-id":"video-end-card",height:"100%",width:"100%",children:(0,f.jsxs)(l.Ee,{alt:n||"",fit:"contain",naturalHeight:1,naturalWidth:1,src:e,children:[(0,f.jsx)(l.xu,{bottom:!0,dangerouslySetInlineStyle:v,left:!0,opacity:.8,position:"absolute",right:!0,top:!0}),(0,f.jsx)(l.xu,{alignItems:"center",display:"flex",height:"100%",justifyContent:"center",left:!0,position:"absolute",top:!0,width:"100%",children:(0,f.jsx)(l.xu,{children:(0,f.jsx)(l.iP,{onTap:t,rounding:2,children:(0,f.jsxs)(l.xu,{alignItems:"center",display:"flex",padding:2,children:[(0,f.jsx)(l.hU,{accessibilityLabel:i._('Replay', 'closeupVideo.endCard.ReplayButton', 'Button when pressed restarts the video'),icon:"refresh",iconColor:"white",size:"md"}),(0,f.jsx)(l.X6,{color:"light",overflow:"normal",size:"400",children:i._('Replay', 'closeupVideo.endCard.ReplayButton', 'Button when pressed restarts the video')})]})})})})]})})};var C=n(293565),k=n(392824),T=n(716920),I=n(361423),j=n(754545),E=n(956077),A=n(15667),R=n(281106),z=n(181663),L=n(123317),V=n(724084),M=n(510928),Z=n(647709),F=n(239728),O=n(104659),N=n(653621),B=n(589357),D=n(720445);function W(e,t,n){var i;return(t="symbol"==typeof(i=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?i:i+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let $=(void 0!==a||(a=n(60533)).hash&&"53ae9ecd15f057f744460205e5d495fd"!==a.hash&&console.error("The definition of 'CloseupVideoNonDuplo_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),a),H=(e,t)=>{t({currentTime:e?.currentTime??0,duration:e?.duration??1})};class K extends s.Component{constructor(...e){super(...e),W(this,"state",{controls:"always"===this.props.showControls&&!this.props.disabled,fullscreen:!1,playing:!(0,C.G6)(this.props.requestContext.userAgent.browserName)&&!!this.props.autoplay&&!this.props.disabled,ready:!1,seeking:!1,showEndCard:!1,volume:this.props.muted||this.props.shouldMute?0:1,videoStartTime:this.props.videoStartTime||0}),W(this,"setVideoPwtLoadingStop",(e=!1)=>{if(!I.Z)return;let{storyPinStepStopwatch:t,pinId:n}=this.props;t&&(e||t.addAnnotation("video.startup.end"),t.addBinaryAnnotation("pin.id",n,"STRING"),t.addBinaryAnnotation("video",!0,"BOOL"),t.addBinaryAnnotation("preload",e,"BOOL"),t.addSubspan({name:"perceived_video_load",endTime:I.Z.now()}),t.stop()),e||(0,k.ZP)("video.startup.end"),(0,k.L8)("perceived_video_load"),(0,E.Nx)(N._z),(0,E.rt)("pin.id",n,"STRING"),(0,E.rt)("video",!0,"BOOL"),"STORY_PIN_CLOSEUP"===(0,j.Ly)()&&(0,E.l7)(N.pM)}),W(this,"componentDidMount",()=>{let{customThumbnail:e,video:t,preferMp4:n}=this.props,{mp4:i}=t,a=t.hlsv3||t.hls||null,{thumbnail:o}=n&&i||a||{},s=(0,B.j4)(e||o);s?.ready===4&&(this.setState({ready:!0}),this.props.autoplay&&this.setVideoPwtLoadingStop(!0)),document.addEventListener("fullscreenchange",this.onFullscreenChange),document.addEventListener("webkitfullscreenchange",this.onFullscreenChange),document.addEventListener("mozfullscreenchange",this.onFullscreenChange),document.addEventListener("MSFullscreenChange",this.onFullscreenChange)}),W(this,"componentWillUnmount",()=>{document.removeEventListener("fullscreenchange",this.onFullscreenChange),document.removeEventListener("webkitfullscreenchange",this.onFullscreenChange),document.removeEventListener("mozfullscreenchange",this.onFullscreenChange),document.removeEventListener("MSFullscreenChange",this.onFullscreenChange)}),W(this,"onFullscreenChange",()=>{document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||this.props.setPanelOpen(e=>!e)}),W(this,"componentDidUpdate",(e,t)=>{this.props.videoStartTime&&this.props.videoStartTime!==e.videoStartTime&&this.setState({videoStartTime:this.props.videoStartTime}),!1===e.isPlaying&&this.props.isPlaying&&this.setState({playing:!0,controls:"never"!==this.props.showControls}),e.isPlaying&&!1===this.props.isPlaying&&this.setState({playing:!1}),e.autoplay!==this.props.autoplay&&(this.setState({playing:!!this.props.autoplay}),this.props.autoplay&&this.state.ready&&this.setVideoPwtLoadingStop(!0)),e.muted!==this.props.muted&&this.setState({volume:+!this.props.muted}),"never"===this.props.showControls&&t.controls&&this.setState({controls:!1}),(t.controls||t.playing)&&this.props.disabled&&this.setState({playing:!1,controls:!1}),!t.playing&&this.state.playing&&this.props.onPlay&&this.props.onPlay(),this.props.isCloseupMediaViewerOpen&&!e.isCloseupMediaViewerOpen&&this.setState({playing:!1})}),W(this,"handleTouch",()=>{let{seeking:e}=this.state,{disabled:t}=this.props;e||t||this.setState(e=>({playing:!e.playing}))}),W(this,"handleShowControls",()=>this.setState({controls:!0})),W(this,"handleHideControls",()=>this.setState({controls:!1})),W(this,"handleReady",()=>{let{ready:e,playing:t}=this.state,{autoplay:n,disabled:i}=this.props;n&&!e&&this.setVideoPwtLoadingStop(),this.setState({ready:!0}),(0,C.G6)(this.props.requestContext.userAgent.browserName)&&!t&&n&&!i&&this.setState({playing:!0})}),W(this,"handleEnded",({event:e})=>{let{customThumbnail:t,customEndCard:n,pinId:i,setCurrentVideo:a,loop:o,onEnded:s}=this.props;e.stopPropagation(),!o&&(this.setState({playing:!1}),t&&t.endsWith(".gif")||n||(this.setState({showEndCard:!0,videoStartTime:0}),a({pinId:i,isPromoted:!1,currentTime:0})),this.state.fullscreen&&this.exitFullscreen()),s&&s(),this.props.setPanelOpen(!0)}),W(this,"handlePause",({event:e})=>{e.stopPropagation(),this.setState({playing:!1})}),W(this,"handlePlay",({event:e})=>{e.stopPropagation(),this.setState({playing:!0})}),W(this,"handleFullscreenChange",({event:e,fullscreen:t})=>{e.stopPropagation(),this.setState({fullscreen:t})}),W(this,"handlePlayheadDown",()=>{this.setState({seeking:!0})}),W(this,"handlePlayheadUp",()=>{setTimeout(()=>{this.setState({seeking:!1})},500)}),W(this,"handleRestartVideo",({event:e})=>{e.stopPropagation(),this.setState({playing:!0,showEndCard:!1})}),W(this,"handleShareRestartVideo",({event:e})=>{e.stopPropagation(),this.setState({playing:!0,showEndCard:!1})}),W(this,"handleVolumeChange",({event:e,volume:t})=>{let{shouldMute:n}=this.props;e.stopPropagation(),n||this.setState({volume:t})}),W(this,"exitFullscreen",()=>{let{document:e}=window;(e.fullscreenElement||e.webkitFullscreenElement||e.mozFullScreenElement)&&(e.exitFullscreen?e.exitFullscreen():e.webkitExitFullscreen?e.webkitExitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.msExitFullscreen&&e.msExitFullscreen())}),W(this,"requestFullscreen",()=>{let{customThumbnail:e,video:t,preferMp4:n}=this.props,{mp4:i}=t,a=t.hlsv3||t.hls||null,{thumbnail:o}=n&&i||a||{},s=(0,B.j4)(e||o);s.requestFullscreen?s.requestFullscreen():s.webkitRequestFullscreen?s.webkitRequestFullscreen():s.mozRequestFullScreen?s.mozRequestFullScreen():s.msRequestFullscreen&&s.msRequestFullscreen()}),W(this,"renderCloseupVideoEndCard",(e,t,n,i)=>{let a={backgroundImage:e,naturalHeight:t,naturalWidth:n,onRestartVideo:this.handleShareRestartVideo},o={backgroundImage:e,naturalHeight:t,naturalWidth:n,onRestartVideo:this.handleRestartVideo},{clientTrackingParams:s,flyoutShareProps:l}=this.props,r={clientTrackingParams:s,gridDescription:l?l.gridDescription:"",imageSrc:l?l.imageSrc:"",isFlyoutOpen:!!l&&l.isFlyoutOpen,onFlyoutDismiss:l?l.onFlyoutDismiss:()=>{},onToggleFlyout:l?l.onToggleFlyout:()=>{},pinId:l?l.pinId:"",pinKey:this.props.pin,variant:this.props.variant};return i?(0,f.jsx)(w,{...o}):(0,f.jsx)(S,{...r,...a})})}render(){let{aspectRatio:e,autoplay:t,closeupStoryPinViewability:n,contextLogData:i={component:179,is_closeup_video:!0,objectId:this.props.pinId,view:3,viewParameter:156},customThumbnail:a,isPromoted:o,loop:s,objectFit:d,preferMp4:u,preload:p,requestContext:h,showControls:m,variant:g,video:y,captions:_,isDesktop:b,videoThumbnailStartTime:v,pin:x,pinId:P,setProgressInfo:S,progressInfo:w,setPanelOpen:k,panelOpen:T,setMute:I,isMuted:j,closeupWithinMasonryEnabled:E,maxHeight:A,maxWidth:V,onTimeChange:M,seekTime:Z,roundingOverride:O}=this.props;i.is_closeup_video=!0;let{controls:N,fullscreen:W,playing:$,showEndCard:K,volume:U,videoStartTime:G}=this.state,X=y.hlsv3||y.hls||null;if(!X&&!y.mp4)return null;let{mp4:q}=y,J=u&&q&&q.url||X&&[{type:"video/m3u8",src:X.url}]||void 0,{height:Y,thumbnail:Q,width:ee}=u&&q||X||{},et=a||Q,en=()=>{k&&k(!T),T&&b&&this.requestFullscreen()},ei=()=>{this.setState({volume:+!!j}),I(!j)},ea=()=>{this.setState({playing:!0})},eo=()=>{this.setState({playing:!1})},es=()=>{this.setState({playing:!$})};return(0,f.jsxs)(l.zd,{height:E||"media-viewer"===g?"inherit":void 0,rounding:O,wash:!E&&"media-viewer"!==g||void 0,width:E||"media-viewer"===g?"inherit":void 0,willChangeTransform:!((0,C.G6)(h.userAgent.browserName)&&W),children:[K?this.renderCloseupVideoEndCard(et??"",Y??1,ee??1,o):(0,f.jsxs)(l.iP,{accessibilityLabel:this.props.i18n._('Pause or play video', 'pin.closeup.video.tap', 'tap area to pause or play video'),fullHeight:E||"media-viewer"===g,onMouseEnter:"hover"===m?this.handleShowControls:void 0,onMouseLeave:"hover"===m?this.handleHideControls:void 0,onTap:this.handleTouch,rounding:2,children:[(0,f.jsx)(R.Z,{playing:$,zIndexValue:99}),(0,f.jsx)(c.Z,{id:"VideoWithContextLogging",children:(0,f.jsx)(D.ZP,{aspectRatio:e??(ee??1)/(Y??1),backgroundColor:E?"black":r.yc,captions:_,closeupStoryPinViewability:n,contextLogData:{...i,video_id:this.props.video.id},hlsConfig:{startLevel:B.VS},isAutoPlay:!!t,loop:s,objectFit:d,onControlsPause:this.handlePause,onControlsPlay:this.handlePlay,onEnded:this.handleEnded,onFullscreenChange:this.handleFullscreenChange,onPlay:()=>{},onPlayError:()=>{},onPlayheadDown:this.handlePlayheadDown,onPlayheadUp:this.handlePlayheadUp,onReady:this.handleReady,onTimeChange:"storyPin"===g?M:({time:e})=>{H&&"number"==typeof q?.duration&&q.duration>0&&S&&H({currentTime:e,duration:q.duration/F.gJ},S)},onVolumeChange:this.handleVolumeChange,pin:x,pinKey:x,playing:$,poster:et,preferMp4:u,preload:p,seekTime:Z,src:J,variant:g,video:u&&q||X||{},videoStartTime:G||v,volume:U})})]}),(0,f.jsx)(l.xu,{onMouseEnter:"hover"===m?this.handleShowControls:void 0,onMouseLeave:"hover"===m?this.handleHideControls:void 0,children:"storyPin"!==g&&(0,f.jsx)(l.xu,{bottom:!0,dangerouslySetInlineStyle:{__style:{...N?{...B.Ul}:{},flexDirection:"column-reverse"}},display:"flex",height:B.hy,maxHeight:A,maxWidth:V,paddingX:6,position:"absolute",width:"100%",zIndex:L.Gf,children:(0,f.jsx)(c.Z,{id:"IdeaPinVideoScrubber",children:(0,f.jsx)(z.Z,{activePageIndex:0,captionsUrl:_,handleMute:ei,handlePanelChange:en,handlePause:eo,handlePausePlay:es,handlePlay:ea,handleWatchAgain:this.handleRestartVideo,inMilliseconds:!1,isMuted:j,isPanelOpen:T,isPlaying:$,isStoryPin:!1,pageCount:1,pages:[],pinId:P,progressInfo:w,showEndCard:K,showVideoControls:N,viewParameter:156})})})})]})}componentDidMount(){(0,o.Z)("CloseupVideo","/app/common/react/components/video/closeup/CloseupVideo.tsx")}}function U(e){(0,s.useEffect)(()=>{(0,o.Z)("CloseupVideo","/app/common/react/components/video/closeup/CloseupVideo.tsx")},[]);let{pinKey:t,pinId:n,isPromoted:i,video:a,muted:l,variant:u}=e,p=(0,m.Z)($,t),h=(0,g.ZP)(),_=(0,A.B)(),b=(0,T.g)(),{seekTimes:v}=(0,V.Hx)(),{clientTrackingParams:x,closeupWithinMasonryEnabled:P,isCloseupMediaViewerOpen:S}=(0,y.x4)(),{maxWidth:w}=(0,r.Re)(),{appUI:C,setCurrentVideo:k}=(0,O.G)(),{videosAutoplaying:I}=C,{organicVideosAutoplaying:j,promotedVideosAutoplaying:E}=I,R=_.locale.toLowerCase(),z=(a.mp4?.captions_urls||a.hlsv3?.captions_urls)??{},L=R&&z[R]||Object.values(z)[0]||"",F=(0,Z.HG)(),N=i?E[n]:j[n],B=parseInt((0,M.Z)().t||0,10),[D,W]=(0,s.useState)(N?.currentTime||0),[H,U]=(0,s.useState)(null),[G,X]=(0,s.useState)(!0),[q,J]=(0,s.useState)(l),{maxHeight:Y}=(0,d.Z)({pinKey:p});(0,s.useEffect)(()=>{let e=D;B>0&&(e=B),v[n]&&(e=v[n]),W(e)},[v,n,B,D]);let Q=(0,s.useMemo)(()=>("default"!==u||!S)&&(!N||!N.paused),[u,N,S]);return(0,f.jsx)(c.Z,{id:"CloseupVideoInner",children:(0,f.jsx)(K,{...e,captions:String(L)||"",clientTrackingParams:x,closeupWithinMasonryEnabled:P,i18n:h,isCloseupMediaViewerOpen:S,isDesktop:F,isMuted:q,isPanelOpen:G,isPlaying:Q,maxHeight:Y,maxWidth:"media-viewer"===u?void 0:w,panelOpen:G,pin:p,progressInfo:H,requestContext:_,seekTime:v[n],setCurrentVideo:k,setMute:J,setPanelOpen:X,setProgressInfo:U,storyPinStepStopwatch:b,variant:u,videoStartTime:D})})}W(K,"defaultProps",{loop:!1,showControls:"hover"})},974297:function(e,t,n){n.d(t,{Z:()=>i});function i(e){return e?[e["736x"],e["564x"],e["474x"],e["236x"]].find(e=>e?.url)??null:null}},291892:function(e,t,n){n.d(t,{Z:()=>l});var i=n(281098),a=n(667294),o=n(284778),s=n(785893);function l({alt:e,children:t,color:n,elementTiming:l,fetchPriority:r,isActive:d=!1,naturalHeight:c,naturalWidth:u,onLoad:p,src:h,fit:m="none",srcSet:g,...y}){(0,a.useEffect)(()=>{(0,i.Z)("ImageWithPerfTiming","/app/packages/pwt-logger/ImageWithPerfTiming.tsx")},[]);let _=(0,a.useRef)(null),f=(0,a.useRef)(null);return(0,a.useEffect)(()=>{if(h!==_.current||d&&d!==f.current){_.current=h??null;let e=document.querySelector(`img[src="${h}"]`)||null;e?.complete&&p()}f.current=d},[h,p,d]),(0,s.jsx)(o.Z,{...y,alt:e,color:n,elementTiming:l,fetchPriority:r,fit:m,naturalHeight:c,naturalWidth:u,onLoad:p,src:h,srcSet:g,children:t})}},658673:function(e,t,n){n.d(t,{Z:()=>x});var i=n(667294),a=n(729434),o=n(901360),s=n(592109),l=n(735201),r=n(645214),d=n(979817),c=n(868178),u=n(375730),p=n(594885),h=n(932885),m=n(986906),g=n(970773),y=n(361423);let _=(0,s.XV)("PwtStopwatch"),f=(e,t)=>{if(y.Z){if("start"===t.type&&!e.isTiming){let{name:n,startTime:i,navigationType:a}=t;return(0,o.A9)(`TIMING.${n}`),{isTiming:!0,name:n,isSampled:t.isSampled,startTime:"number"==typeof i?i:y.Z.now(),metricId:{type:"stopwatch",name:n,navigationType:a},pwtStaticContext:t.pwtStaticContext,annotations:e.annotations,binaryAnnotations:e.binaryAnnotations,spans:e.spans,traceId:e.traceId,spanNameUpdates:e.spanNameUpdates}}if(!e.isTiming)if(t.bypassIsTimingCheck)_("allowing action while stopwatch is not actively timing (bypassIsTimingCheck is set to true)",t);else{let n=t.name||e.name;return _("ignoring action - stopwatch is not actively timing",t),(0,o.A9)(`WARN.${n}.noTiming.${t.type}`),e}if("annotate"===t.type){let n=y.Z.now();return _(`adding annotation {${t.label}: ${n}}`),{...e,annotations:e.annotations.concat([{label:t.label,timestamp:n}])}}if("binaryAnnotate"===t.type)return _(`adding binary annotation {${t.name}: ${String(t.value)}}`),{...e,binaryAnnotations:{...e.binaryAnnotations,...{[t.name]:{value:t.value,type:t.annotationType}}}};if("binaryAnnotateOperation"===t.type){let{value:n,type:i}=t.binaryAnnotationValueAndType;if(!e.binaryAnnotations[t.name])return{...e,binaryAnnotations:{...e.binaryAnnotations,...{[t.name]:{value:n,type:i}}}};{let a=e.binaryAnnotations[t.name].value||0;return _(`operating on binary annotation {
          name: ${t.name}
          pervious value: ${String(a)}
          operand: ${String(n)}
        }`),{...e,binaryAnnotations:{...e.binaryAnnotations,...{[t.name]:{value:n?t.operation(a,n):a,type:i}}}}}}if("addSubspan"===t.type){_(`adding subspan {${t.name}}`),-1!==e.spans.findIndex(e=>e.name===t.name)&&_(`WARNING: adding duplicate subspan name {${t.name}}`);let n=t.id||(0,g.Z)();-1!==e.spans.findIndex(e=>e.id===n)&&_(`WARNING: adding duplicate subspan id {${t.name}: ${n}}`);let i=0;return t.startTime?i=t.startTime:e.startTime?i=e.startTime:_(`WARNING: adding subspan {${t.name}} without start time`),{...e,spans:[...e.spans,{name:t.name,id:n,startTime:i,endTime:t.endTime||1/0,annotationMap:{...t.annotations},binaryAnnotationMap:{...t.binaryAnnotations},parentId:t.parentId}]}}if("subspanStart"===t.type){_(`starting subspan {${t.name}}`),-1!==e.spans.findIndex(e=>e.name===t.name)&&_(`WARNING: starting duplicate subspan name {${t.name}}`);let n=t.id||(0,g.Z)();-1!==e.spans.findIndex(e=>e.id===n)&&_(`WARNING: starting duplicate subspan id {${t.name}: ${n}}`);let i=t.parentName?e.spans.find(e=>e.name===t.parentName)?.id:null;return{...e,spans:[...e.spans,{name:t.name,id:n,parentId:t.parentId||i,startTime:y.Z.now(),endTime:1/0,annotationMap:{...t.annotations},binaryAnnotationMap:{...t.binaryAnnotations}}]}}if("subspanStop"===t.type){_(`stopping subspan {${t.name}}`),!t.id&&e.spans.filter(e=>e.name===t.name).length>1&&(0,o.H)("duplicate_subspan_stop_name",{name:t.name,type:t.type});let n=t.id?e.spans.findIndex(e=>e.id===t.id):e.spans.findIndex(e=>e.name===t.name);return n>-1?(e.spans[n].endTime=y.Z.now(),t.annotations&&(e.spans[n].annotationMap={...e.spans[n].annotationMap,...t.annotations}),t.binaryAnnotations&&(e.spans[n].binaryAnnotationMap={...e.spans[n].binaryAnnotationMap,...t.binaryAnnotations})):(0,o.H)("invalid_subspan_stop_name",{name:t.name}),e}if("subspanUpdateName"===t.type){e.spans.filter(e=>e.name===t.currentName).length>1&&(0,o.H)("duplicate_subspan_stop_name",{name:t.currentName,type:t.type});let n=e.spans.findIndex(e=>e.name===t.currentName);return n>-1?t.updateWhenStopwatchCompletes?e.spanNameUpdates=[...e.spanNameUpdates,{currentName:t.currentName,newName:t.newName}]:(_(`renaming subspan {${t.currentName}} to {${t.newName}}`),e.spans[n].name=t.newName):(0,o.H)("no_subspan_found_to_rename",{name:t.currentName}),e}if("stop"===t.type&&e.isTiming){let{startTime:n,metricId:i,pwtStaticContext:a,annotations:o,binaryAnnotations:s,isSampled:p,spans:m,traceId:f}=e;if(t.stopwatchPerformanceObserver&&t.stopwatchPerformanceObserver.disconnect(),p){let l=t.stopTime||y.Z.now(),p=[...m.map(t=>{t.endTime===1/0&&(t.endTime=l);let n=e.spanNameUpdates.findIndex(e=>t.name===e.currentName);return n>-1&&(_(`renaming subspan {${t.name}} to {${e.spanNameUpdates[n].newName}}`),t.name=e.spanNameUpdates[n].newName,e.spanNameUpdates=e.spanNameUpdates.filter(e=>e.newName!==t.name)),t})];if(t.manualAndResourceSpans||0===m.length){let e=(0,g.Z)();p.push({name:"network_resources",id:e,startTime:n,endTime:l,annotationMap:{},binaryAnnotationMap:{},parentId:null},...(t.customStopwatchBuffer||[]).map(t=>(0,u.Z)((0,d.p)(t,[]),e)).filter(Boolean))}let b={type:"COMPLETE",metricId:i,traceId:f,startTime:n,endTime:l,spans:p,annotationMap:{...(0,h.Z)(o)},binaryAnnotationMap:(0,r.ng)({metricId:i,pwtStaticContext:a,binaryAnnotations:s,performanceResourceTimings:t.customStopwatchBuffer||[],type:"COMPLETE"})};(0,c.Z)({metricId:i,pwtStaticContext:a,result:b})}return(0,l.$B)(),{isTiming:!1,name:e.name,annotations:[],binaryAnnotations:{},spans:[],traceId:(0,g.Z)(),spanNameUpdates:[]}}if("error"===t.type){let{error:n,stopwatchPerformanceObserver:i}=t;return n&&(0,o.H)(n),i&&i.disconnect(),(0,l.$B)(),{isTiming:!1,name:e.name,annotations:[],binaryAnnotations:{},spans:[],traceId:(0,g.Z)(),spanNameUpdates:[]}}if("abort"===t.type&&e.isTiming){t.stopwatchPerformanceObserver&&t.stopwatchPerformanceObserver.disconnect();let n=t.reason||"",{startTime:i,metricId:a,pwtStaticContext:o,binaryAnnotations:s,traceId:d}=e,u={type:"ABORT",traceId:d,startTime:i,endTime:y.Z.now(),spans:[],annotationMap:{},binaryAnnotationMap:(0,r.ng)({metricId:a,pwtStaticContext:o,binaryAnnotations:s,performanceResourceTimings:t.customStopwatchBuffer||[],type:"ABORT"}),reason:n};return(0,c.Z)({metricId:a,pwtStaticContext:o,result:u}),(0,l.$B)(),{isTiming:!1,name:e.name,annotations:[],binaryAnnotations:{},spans:[],traceId:d,spanNameUpdates:[]}}}return e};var b=n(891631),v=n(785893);let x=({name:e,sampleRate:t,abortOnUnloadOrClientNavigation:n=!0,navigationType:s,manualAndResourceSpans:r=!1})=>{let{Provider:d,useMaybeHook:c}=(0,a.Z)(`Stopwatch_${e}`);return{Provider:function({children:a}){let c=(({name:e,sampleRate:t,navigationType:n,manualAndResourceSpans:a=!1})=>{let o=(0,p.Z)(),s=(0,i.useRef)([]),r=(0,i.useRef)(null),d=(0,i.useRef)(null);null===d.current&&(d.current=(0,l.jf)());let[c,u]=(0,i.useReducer)(f,{isTiming:!1,name:e,annotations:[],binaryAnnotations:{},spans:[],traceId:d.current,spanNameUpdates:[]});return o?{isTiming:c.isTiming,name:c.name,start:i=>(window.PerformanceObserver&&(s.current=[],r.current=(0,m.Z)({entryTypes:["resource"]},e=>{s.current=s.current.concat(e.getEntries()),s.current.length>1e3&&(s.current=s.current.slice(-1e3))})),u({type:"start",startTime:i,name:e,navigationType:n,pwtStaticContext:o,isSampled:!t||Math.random()<t})),stop:e=>u({type:"stop",stopTime:e,stopwatchPerformanceObserver:r.current,customStopwatchBuffer:s.current,manualAndResourceSpans:a}),error:e=>{u({type:"error",stopwatchPerformanceObserver:r.current,error:e})},abort:e=>u({type:"abort",stopTime:y.Z?.now(),stopwatchPerformanceObserver:r.current,customStopwatchBuffer:s.current,reason:e}),annotate:(e,t,n=!1)=>u({type:"annotate",label:e,parentId:t,bypassIsTimingCheck:n}),binaryAnnotate:(e,t,n,i,a=!1)=>u({type:"binaryAnnotate",name:e,value:t,annotationType:n,parentId:i,bypassIsTimingCheck:a}),binaryAnnotateOperation:({name:e,binaryAnnotationValueAndType:t,operation:n,parentId:i,bypassIsTimingCheck:a=!1})=>u({type:"binaryAnnotateOperation",name:e,binaryAnnotationValueAndType:t,operation:n,parentId:i,bypassIsTimingCheck:a}),addSubspan:({name:e,startTime:t,endTime:n,annotations:i={},binaryAnnotations:a={},parentId:o=null,id:s=null,bypassIsTimingCheck:l=!1})=>u({type:"addSubspan",name:e,startTime:t,endTime:n,annotations:i,binaryAnnotations:a,parentId:o,id:s,bypassIsTimingCheck:l}),subspanStart:({name:e,annotations:t={},binaryAnnotations:n={},parentId:i=null,parentName:a=null,id:o=null,bypassIsTimingCheck:s=!1})=>u({type:"subspanStart",name:e,annotations:t,binaryAnnotations:n,parentId:i,parentName:a,id:o,bypassIsTimingCheck:s}),subspanStop:({name:e,annotations:t,binaryAnnotations:n,id:i,parentId:a,bypassIsTimingCheck:o=!1})=>u({type:"subspanStop",name:e,annotations:t,binaryAnnotations:n,id:i,parentId:a,bypassIsTimingCheck:o}),subspanUpdateName:({currentName:e,newName:t,bypassIsTimingCheck:n,updateWhenStopwatchCompletes:i=!0})=>u({type:"subspanUpdateName",currentName:e,newName:t,bypassIsTimingCheck:n,updateWhenStopwatchCompletes:i}),getSpans:(e,t)=>c.spans.filter(n=>n[e]===t),getTraceId:()=>c.traceId}:null})({name:e,sampleRate:t,navigationType:s,manualAndResourceSpans:r}),u=(0,b.Z)(),h=u?u.time:0,g=(0,i.useRef)(!1),_=c?.isTiming,x=(0,i.useCallback)(t=>{g.current?(g.current=!1,c?.abort(t)):(0,o.A9)(`WARN.${e}.noTiming.abort`)},[c]),P=(0,i.useCallback)((e,t)=>{c?.annotate(e,t)},[c]),S=(0,i.useCallback)((e,t,n,i)=>{c?.binaryAnnotate(e,t,n,i)},[c]),w=(0,i.useCallback)(({name:e,binaryAnnotationValueAndType:t,operation:n,parentId:i,bypassIsTimingCheck:a})=>{c?.binaryAnnotateOperation({name:e,binaryAnnotationValueAndType:t,operation:n,parentId:i,bypassIsTimingCheck:a})},[c]),C=(0,i.useCallback)(({name:e,startTime:t,endTime:n,annotations:i,binaryAnnotations:a,parentId:o,id:s,bypassIsTimingCheck:l})=>{c?.addSubspan({name:e,startTime:t,endTime:n,annotations:i,binaryAnnotations:a,parentId:o,id:s,bypassIsTimingCheck:l})},[c]),k=(0,i.useCallback)(({name:e,annotations:t,binaryAnnotations:n,parentId:i,parentName:a,id:o,bypassIsTimingCheck:s})=>{c?.subspanStart({name:e,annotations:t,binaryAnnotations:n,parentId:i,parentName:a,id:o,bypassIsTimingCheck:s})},[c]),T=(0,i.useCallback)(({name:e,annotations:t,binaryAnnotations:n,id:i,parentId:a,bypassIsTimingCheck:o})=>{c?.subspanStop({name:e,annotations:t,binaryAnnotations:n,id:i,parentId:a,bypassIsTimingCheck:o})},[c]),I=(0,i.useCallback)(({currentName:e,newName:t,bypassIsTimingCheck:n,updateWhenStopwatchCompletes:i})=>{c?.subspanUpdateName({currentName:e,newName:t,bypassIsTimingCheck:n,updateWhenStopwatchCompletes:i})},[c]),j=(0,i.useCallback)((e,t)=>c?c.getSpans(e,t):[],[c]),E=(0,i.useCallback)(()=>c?c.getTraceId():"",[c]),A=(0,i.useCallback)(t=>{g.current?(g.current=!1,c?.error(t)):(0,o.A9)(`WARN.${e}.noTiming.error`)},[c]),R=(0,i.useCallback)(e=>{g.current&&c?.abort("duplicated_init_stopwatch_action"),g.current=!0,c?.start(e)},[c]),z=(0,i.useCallback)(t=>{g.current?(g.current=!1,c?.stop(t)):(0,o.A9)(`WARN.${e}.noTiming.stop`)},[c]);(0,i.useEffect)(()=>()=>{n&&x("unloadOrClientNavigation")},[h]);let L=(0,i.useMemo)(()=>({name:e,isTiming:_,abort:x,addAnnotation:P,addBinaryAnnotation:S,binaryAnnotationOperation:w,addSubspan:C,subspanStart:k,subspanStop:T,getSpans:j,getTraceId:E,updateSubspanName:I,stop:z,error:A,start:R}),[_,x,P,S,w,C,k,T,j,E,I,z,A,R]);return(0,v.jsx)(d,{value:L,children:a})},get:c}}},716920:function(e,t,n){n.d(t,{T:()=>o,g:()=>s});let{Provider:i,get:a}=(0,n(658673).Z)({name:"story_pin_step",sampleRate:1}),o=i,s=a},932885:function(e,t,n){n.d(t,{Z:()=>i});let i=e=>{let t={};e.forEach(({label:e,timestamp:n})=>{t={...t,[e]:(t[e]||[]).concat([n])}});let n=Object.freeze({});return Object.keys(t).forEach(e=>{(t[e]||[]).forEach((t,i)=>{let a=i?`${e}_${i+1}`:e;n={...n,[a]:t}})}),n}},281106:function(e,t,n){n.d(t,{Z:()=>c});var i=n(281098),a=n(667294),o=n(20256),s=n(883817),l=n(369416),r=n(123317),d=n(785893);function c({playing:e,zIndexValue:t}){return(0,a.useEffect)(()=>{(0,i.Z)("PausePlayOverlay","/app/packages/story-pin/Closeup/PausePlayOverlay.tsx")},[]),(0,d.jsxs)(a.Fragment,{children:[(0,d.jsx)(l.Z,{unsafeCSS:"#story-pin-closeup-pause-play-overlay svg { filter: drop-shadow( 0px 0px 8px rgba(0,0,0,0.1));}"}),(0,d.jsx)(o.xu,{alignItems:"center",bottom:!0,dangerouslySetInlineStyle:{__style:{pointerEvents:"none"}},"data-test-id":"story-pin-closeup-pause-play-overlay",display:"flex",id:"story-pin-closeup-pause-play-overlay",justifyContent:"center",left:!0,opacity:.8,position:"absolute",right:!0,rounding:r.yR,top:!0,zIndex:t?new o.Ry(t):s.p8,children:!e&&(0,d.jsx)(o.JO,{accessibilityLabel:"Play",color:"light",icon:"play",size:48})})]})}},181663:function(e,t,n){n.d(t,{Z:()=>v});var i=n(281098),a=n(667294),o=n(20256),s=n(19585),l=n(453179),r=n(579935),d=n(123317),c=n(724084),u=n(941404),p=n(572227),h=n(647709),m=n(239728),g=n(792171),y=n(601686),_=n(785893);let f=()=>{},b=({accessibilityLabel:e,dataTestId:t,disable:n,handleTap:i,icon:a})=>(0,_.jsx)(o.xu,{"data-test-id":t,opacity:n?.5:void 0,children:(0,_.jsx)(o.iP,{disabled:n,onTap:i,children:(0,_.jsx)(o.JO,{accessibilityLabel:e,color:"light",icon:a,size:16})})});function v({activePageIndex:e,handlePanelChange:t,handlePlay:n,handlePause:v,handlePausePlay:x,handleMute:P,handleVideoScrubbingNewPage:S,handleWatchAgain:w,inMilliseconds:C,isPlaying:k,isMuted:T,isPanelOpen:I,pages:j,pageCount:E,pinId:A="",progressInfo:R,showEndCard:z,showVideoControls:L=!1,viewParameter:V,isStoryPin:M=!0,captionsUrl:Z=""}){(0,a.useEffect)(()=>{(0,i.Z)("IdeaPinVideoScrubber","/app/packages/story-pin/Closeup/VideoScrubber/IdeaPinVideoScrubber.tsx")},[]);let F=(0,s.ZP)(),{currentTime:O}=R||{},{seekTimes:N}=(0,c.Hx)(),{closeupWithinMasonryEnabled:B}=(0,y.x4)(),D=(0,g.H)(),W=(0,h.HG)(),{captionsEnabled:$}=D,H=(0,p.Z)(),K=j[e],{should_mute:U}=K||T,G=Object.keys(N).includes(A)&&N[A]?N[A]:O,X=(0,a.useMemo)(()=>j.map(e=>{let t=e.blocks?.find(e=>3===e.block_type),n=t?.video?.video_list?.V_HLSV3_MOBILE?.duration||t?.video?.video_list?.V_720P?.duration;return n?{duration:n,isVideo:!0}:{duration:l.oN,isVideo:!1}}),[j]),q=[{duration:R?.duration||0,isVideo:!0}],J=M?X:q,Y=(K&&K.blocks?.[0]||{}).video?.video_list?.V_HLSV3_MOBILE?.captions_urls,Q=!1;(Y&&0!==Object.keys(Y).length||Z)&&(Q=!0);let ee=(0,a.useMemo)(()=>J.reduce((e,t)=>e+(t.duration||0),0)/(M?m.gJ:1),[J,M]),et=(0,a.useMemo)(()=>J.filter((t,n)=>n<e).reduce((e,t)=>e+(t.duration||0),0)/m.gJ,[J,e]),en=J.length>0&&J[e]?.isVideo?O??0:(O??0)*5+(et??0),ei=F._('Hide captions', 'gestalt.video.accessibilityHideCaptionsLabel', 'ARIA label for hide captions button'),ea=F._('Show captions', 'gestalt.video.accessibilityShowCaptionsLabel', 'ARIA label for show captions button');return(0,_.jsxs)(o.xu,{alignContent:"evenly",alignItems:"baseline",dangerouslySetInlineStyle:{__style:{gap:"18.5px",pointerEvents:"auto"}},direction:"column",display:"flex",justifyContent:"between",width:"100%",children:[(0,_.jsxs)(o.xu,{alignItems:"center",dangerouslySetInlineStyle:{__style:{opacity:L||!k?1:0,transition:"all .1s"}},direction:"row",display:"flex",justifyContent:"between",width:"99%",children:[(0,_.jsxs)(o.kC,{alignItems:"center",direction:"row",gap:5,children:[(0,_.jsx)(b,{accessibilityLabel:k?F._('Pause', 'closeup.IdeaPinVideo.Pause', 'Pause button on Idea Pin video'):F._('Play', 'closeup.IdeaPinVideo.Play', 'Play button on Idea Pin video'),dataTestId:`story-pin-closeup-${k?"pause":"play"}`,handleTap:z&&w?w:x,icon:k?"pause":"play"}),R&&(0,_.jsx)(o.iP,{children:(0,_.jsxs)(o.xu,{"aria-label":`${F._('Video duration', 'closeup.IdeaPinVideo.durationLabel', 'Screen reader label for video duration display')}: ${(0,d.Lc)(en)} of ${(0,d.Lc)(ee)}`,"data-test-id":"time-display",children:[(0,_.jsx)(o.xv,{align:"end",color:"inverse",inline:!0,overflow:"normal",size:"300",weight:"bold",children:`${(0,d.Lc)(en)}`})," ",(0,_.jsx)(o.xu,{display:"inlineBlock",opacity:.6,children:(0,_.jsx)(o.xv,{align:"end",color:"inverse",inline:!0,overflow:"normal",size:"300",weight:"bold",children:`/ ${(0,d.Lc)(ee)}`})})]})})]}),(0,_.jsxs)(o.kC,{direction:"row",gap:5,children:[Q&&(0,_.jsx)(b,{accessibilityLabel:$?ea:ei,dataTestId:`closed-captions-button-${$?"disable":"enable"}`,handleTap:()=>{let e=W?"desktop_pin_page":"mweb_pin_page";$?(0,u.My)(`${e}.closed_captions_button.toggle_off`):(0,u.My)(`${e}.closed_captions_button.toggle_on`),H({action:"click",item:"closed-captions-button"}),D.setCaptionsEnabled(!$)},icon:$?"captions":"captions-outline"}),(0,_.jsx)(b,{accessibilityLabel:T?F._('Unmute', 'closeup.IdeaPinVideo.unmute', 'Unmute button on Idea Pin video'):F._('Mute', 'closeup.IdeaPinVideo.mute', 'Mute button on Idea Pin video'),dataTestId:`story-pin-closeup-${T?"unmute":"mute"}`,disable:U,handleTap:P,icon:T?"mute":"sound"}),t&&!B&&(0,_.jsx)(b,{accessibilityLabel:I?F._('Maximize', 'closeup.IdeaPinVideo.maximize', 'Maximize button on Idea Pin video'):F._('Minimize', 'closeup.IdeaPinVideo.minimize', 'Minimize button on Idea Pin video'),dataTestId:`story-pin-closeup-${I?"maximize":"minimize"}`,handleTap:t||f,icon:I?"maximize":"minimize"})]})]}),(0,_.jsx)(r.ZP,{activePageCurrentTime:G,activePageIndex:e,duration:ee,handlePause:v,handlePlay:n,handleVideoScrubbingNewPage:S,inMilliseconds:C,isPlaying:k,pageCount:E,pageDurations:J,pinId:A,progressInfo:R,shouldShowPlayhead:!0,showEndCard:z,showVideoControls:L,videoDurations:J,viewParameter:V})]})}},579935:function(e,t,n){n.d(t,{$:()=>y,$E:()=>g,ZP:()=>v});var i=n(281098),a=n(667294),o=n(20256),s=n(521009),l=n(19585),r=n(453179),d=n(15667),c=n(785893);function u({pillHeight:e,scrubberWidth:t}){return(0,a.useEffect)(()=>{(0,i.Z)("PaginationProgressPill","/app/packages/story-pin/Closeup/VideoScrubber/PaginationProgressPill.tsx")},[]),(0,c.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{backgroundColor:g}},display:"flex",flex:"grow",height:e,overflow:"hidden",rounding:"pill",children:(0,c.jsx)(o.xu,{color:y,dangerouslySetInlineStyle:{__style:{width:t}},"data-test-id":"video-progress-bar",height:"100%",rounding:"pill"})})}var p=n(724084),h=n(647709),m=n(239728);let g="rgba(255,255,255,0.24)",y="light",_=()=>{},f=({children:e,setHoveringChange:t,handleMouseDown:n,handleMouseLeave:i,handleTouchStart:a,playhead:s,isPlaying:r,showVideoControls:d})=>{let u=(0,l.ZP)(),p=!(0,h.HG)();return(0,c.jsx)(o.iP,{children:(0,c.jsx)(o.xu,{ref:s,alignItems:"center","aria-label":u._('Video scrubber progress bar', 'ideaPin.closeupvideo.videoScrubberLabel', 'Accessibility label for video scrubber progress bar on video idea pins.'),dangerouslySetInlineStyle:{__style:{pointerEvents:"auto",touchAction:"none"}},"data-test-id":"bullet-video-progress-bar",display:"flex",flex:"grow",justifyContent:p?"center":"start",marginBottom:6*!p,minHeight:"8px",onFocus:t(!0),onMouseDown:n,onMouseLeave:i,onMouseOver:t(!0),onTouchEnd:e=>e.preventDefault(),onTouchStart:a,opacity:d||!r?1:0,paddingY:6*!!p,position:"relative",role:"progressbar",width:"100%",children:e})})},b=({isRTL:e,isSeeking:t,scrubberWidth:n})=>(0,c.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:e?{right:n}:{left:n}},"data-test-id":"video-progress-bar-playhead",position:"relative",children:(0,c.jsx)(o.xu,{color:y,height:4,position:"absolute",rounding:"pill",children:(0,c.jsx)(o.xu,{color:"light",dangerouslySetInlineStyle:{__style:{marginTop:t?-8:-6}},height:t?16:12,marginStart:-2,rounding:"circle",width:t?16:12})})});function v({activePageIndex:e,activePageCurrentTime:t,pageCount:n,progressInfo:l,showEndCard:g,duration:v=0,pageDurations:x=[],handlePlay:P=_,handlePause:S=_,handleVideoScrubbingNewPage:w=_,inMilliseconds:C,videoDurations:k=[],viewParameter:T,isInactiveStreamPin:I=!1,isPlaying:j=!1,setVideoProgress:E,shouldShowPlayhead:A=!1,showVideoControls:R=!0,pinId:z=""}){(0,a.useEffect)(()=>{(0,i.Z)("Pagination","/app/packages/story-pin/Closeup/VideoScrubber/Pagination.tsx")},[]);let L=!(0,h.HG)(),V=(0,a.useRef)(null),{isRTL:M}=(0,d.B)(),[Z,F]=(0,a.useState)(!1),[O,N]=(0,a.useState)(j),[B,D]=(0,a.useState)(),W=(0,s.Z)(),[$,H]=(0,a.useState)(!1),{clearSeekTime:K,updateSeekTime:U}=(0,p.RC)(),G=(0,a.useCallback)((t,i)=>{if(!I&&i<=n){if(i!==e&&w(i),E){let{isVideo:e}=k[i];E({currentTime:t/1e3,duration:e?l?.duration??1:l?.duration??5,pinId:z})}U(t/1e3,z)}W({event_type:101,view_type:3,view_parameter:T,component:14302})},[e,w,I,W,n,z,l?.duration,E,U,k,T]),X=x.map(e=>`${(e.duration||0)/v/10}%`),q=(0,a.useMemo)(()=>{let e=0;return x.map(({duration:t})=>{let n=t+e,i={min:e,max:n};return e=n,i})},[x]),J=Z?"0 1.2px":"0 1px",Y=e=>()=>F(e),Q=(0,a.useCallback)(e=>{if(!V.current)return;let{left:t=0,right:n=0,width:i=0}=V.current.getBoundingClientRect(),a=(M?Math.max(0,Math.min((n-e)/i,1)):Math.max(0,Math.min((e-t)/i,1)))*v*1e3,o=q.findIndex(e=>a>=e.min&&a<=e.max),s=-1===o?0:o;G(a-q[s].min,s)},[v,G,q,M]),ee=(0,a.useCallback)(()=>{$||N(j||g),H(!0)},[$,N,j,g]),et=(0,a.useCallback)(e=>{ee(),j&&S(),Q(e.pageX)},[ee,j,S,Q]),en=(0,a.useCallback)(e=>{$&&Q(e.pageX)},[Q,$]),ei=(0,a.useCallback)(e=>{if($){e.preventDefault();let t=Array.from(e.changedTouches).find(e=>e.identifier===B);t&&Q(t.pageX)}},[$,Q,B]),ea=(0,a.useCallback)(()=>{Y(!1),D(void 0),H(!1),O&&P()},[P,O]),eo=(0,a.useCallback)(e=>{Array.from(e.changedTouches).find(e=>e.identifier===B)&&(Y(!1),D(void 0),H(!1),K()),O&&P()},[K,P,O,B]);return(0,a.useEffect)(()=>($&&!I&&(window.addEventListener("mousemove",en),window.addEventListener("mouseup",ea),window.addEventListener("touchmove",ei),window.addEventListener("touchend",eo)),()=>{window.removeEventListener("mousemove",en),window.removeEventListener("mouseup",ea),window.removeEventListener("touchmove",ei),window.removeEventListener("touchend",eo)}),[en,ea,eo,ei,I,$,Q,O,B]),(0,c.jsx)(f,{handleMouseDown:et,handleMouseLeave:()=>{Y(!1)},handleTouchStart:e=>{ee(),Y(!0);let t=e.changedTouches[0];D(t.identifier),Q(t.pageX)},isPlaying:j,playhead:V,setHoveringChange:Y,showVideoControls:R,children:Array(n).fill(void 0).map((i,a)=>{let s=l?.currentTime??0,d=l?.duration??r.P6,p=k[a],h=`${p?.isVideo&&C?Math.floor(1e4*(t??s)/(p.duration/m.gJ))/100:s/d*100}%`;return(0,c.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{margin:J}},flex:"grow",width:X.length===n?X[a]:"auto",children:(0,c.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{transition:"all .1s"}},"data-test-id":"idea-pin-video-progress-bar",rounding:"pill",children:a<e||g?(0,c.jsx)(o.xu,{color:y,height:4,rounding:"pill"}):e===a&&l?(0,c.jsxs)(o.kC,{alignItems:"center",flex:"grow",children:[A&&(R||Z||$||L)&&(0,c.jsx)(b,{isRTL:M,isSeeking:$,scrubberWidth:h}),(0,c.jsx)(u,{pillHeight:4,scrubberWidth:h})]}):(0,c.jsx)(o.xu,{color:y,dangerouslySetInlineStyle:{__style:{opacity:.24}},height:4,rounding:"pill"})})},`${z}-${a}`)})})}},294711:function(e,t,n){n.d(t,{Z:()=>i});function i({currentTime:e,endTime:t,startTime:n}){return"number"!=typeof n||"number"!=typeof t||!(n>=0)||!(t>0)||!(n<t)||n<=e&&e<=t}},973940:function(e,t,n){n.d(t,{Z:()=>a});var i=n(667294);let a=e=>{let t=(0,i.useRef)(null);return(0,i.useEffect)(()=>{t.current=e},[e]),t.current}},399806:function(e,t,n){n.d(t,{Q:()=>i,Z:()=>a});let i=()=>{let e,t="undefined"!=typeof window?window.navigator?.connection?.effectiveType:void 0,n=!window?.devicePixelRatio||window.devicePixelRatio<=1?"1x":"2x";return t?"4g"===t?e="40-80":(n="1x",e="0-1"):e="unknown",{downloadSpeedGroup:e,screenDimension:n}};function a(e){let{vHLSV3MOBILE:t,...n}=e,a=function({vEXP3:e,vEXP4:t,vEXP5:n,vEXP6:a,vEXP7:o,v720P:s}){let{downloadSpeedGroup:l,screenDimension:r}=i(),d={"1x":e,"2x":n},c={"1x":o,"2x":o};return({unknown:d,"0-1":d,"1-5":{"1x":t,"2x":n},"5-10":{"1x":n,"2x":n},"10-20":{"1x":a,"2x":a},"20-40":c,"40-80":c,"80_or_above":c})[l][r]||s||void 0}(n),o=t||void 0;return a?{hlsv3:o,mp4:a}:{hlsv3:o}}},807765:function(e,t,n){n.d(t,{c:()=>r,f:()=>l});var i=n(667294),a=n(729434),o=n(785893);let{Provider:s,get:l}=(0,a.Z)("CloseupAnimations");function r({children:e}){let[t,n]=(0,i.useState)(!1),[a,l]=(0,i.useState)(!1),r=(0,i.useMemo)(()=>({isShowingShareButton:t,setIsShowingShareButton:n,isShowingVisualSearchButton:a,setIsShowingVisualSearchButton:l}),[t,a]);return(0,o.jsx)(s,{value:r,children:e})}},218831:function(e,t,n){n.d(t,{C:()=>r,K:()=>l});var i=n(281098),a=n(667294),o=n(785893);let s=(0,a.createContext)({closeupBodyWidth:0,isCollageOverlayOpen:!1,isRelatedPins10PercentVisible:!1,setCloseupBodyWidth:()=>{},setIsCollageOverlayOpen:()=>{},setIsRelatedPins10PercentVisible:()=>{}});function l(){let e=(0,a.useContext)(s);if(!e)throw Error("useCloseupBodyContext must be used within CloseupBodyContextProvider");return e}function r({children:e}){(0,a.useEffect)(()=>{(0,i.Z)("Context","/app/www/closeup/desktop/CloseupBody/Context.tsx")},[]);let[t,n]=(0,a.useState)(0),[l,r]=(0,a.useState)(!1),[d,c]=(0,a.useState)(!1),u=(0,a.useMemo)(()=>({closeupBodyWidth:t,setCloseupBodyWidth:n,isCollageOverlayOpen:l,setIsCollageOverlayOpen:r,isRelatedPins10PercentVisible:d,setIsRelatedPins10PercentVisible:c}),[t,l,d]);return(0,o.jsx)(s,{value:u,children:e})}},85574:function(e,t,n){n.d(t,{Z:()=>l});let i={WebkitMaskImage:"-webkit-radial-gradient(white, black)"},a=e=>`${e??0}px`,o=({topLeft:e,topRight:t,bottomRight:n,bottomLeft:i})=>`${a(e)} ${a(t)} ${a(n)} ${a(i)}`,s=({additionalPadding:e=0}={})=>({borderRadius:o({topLeft:24+e,topRight:24+e,bottomRight:24+e,bottomLeft:24+e}),borderRadiusNumeric:24+e});function l({additionalPadding:e,isSideBySide:t,isPadded:n,isRTL:a,closeupWithinMasonryEnabled:l=!1,blendedUIEnabled:r=!1}){let d={additionalPadding:e};if(r)return{borderStyle:{...i,borderRadius:"unset"},borderRadiusNumeric:0};if(l)return{borderStyle:{...i,borderRadius:"24px"},borderRadiusNumeric:24};if(t){let{borderRadius:e,borderRadiusNumeric:t}=(({getterOptions:e,isPadded:t,isRTL:n})=>t?s(e):n?(({additionalPadding:e=0}={})=>({borderRadius:o({topLeft:0,topRight:32+e,bottomRight:32+e,bottomLeft:0}),borderRadiusNumeric:32+e}))(e):(({additionalPadding:e=0}={})=>({borderRadius:o({topLeft:32+e,topRight:0,bottomRight:0,bottomLeft:32+e}),borderRadiusNumeric:32+e}))(e))({isPadded:n,isRTL:a,getterOptions:d});return{borderStyle:{...i,borderRadius:e},borderRadiusNumeric:t}}{let{borderRadius:e,borderRadiusNumeric:t}=(n?s:({additionalPadding:e=0}={})=>({borderRadius:o({topLeft:32+e,topRight:32+e,bottomRight:0,bottomLeft:0}),borderRadiusNumeric:32+e}))(d);return{borderStyle:{...i,borderRadius:e},borderRadiusNumeric:t}}}},653621:function(e,t,n){let i;n.d(t,{GL:()=>s,_z:()=>a,d0:()=>r,hO:()=>l,pM:()=>o});let a="video",o="image",s=new Map([["DEFAULT",new Set(["button"])],["story_pin",new Set([a])],["product_detail_page",new Set(["description","shopButton","thumbnailsLoaded"])],["product_detail_page_plus",new Set(["description","shopButton","thumbnailsLoaded"])]]),l=(i=new Set,s.forEach(e=>{i=new Set([...i,...e])}),i),r=new Set([...l,o,"resource"])},937314:function(e,t,n){n.d(t,{Z:()=>s});var i=n(281098),a=n(667294),o=n(785893);function s({children:e,dir:t="auto"}){return(0,a.useEffect)(()=>{(0,i.Z)("SafeTextDirection","/app/www/storyPins/utility/SafeTextDirection.tsx")},[]),(0,o.jsx)("div",{"data-test-id":"safeTextDirection",dir:t,children:e})}},452750:function(e,t,n){n.d(t,{Z:()=>a});var i=n(640785);function a(e){return{defaultStyle:0,fontFamily:e.name??"",fontGroup:i.gu,fontOverrides:{letterSpacing:e.letter_spacing,lineHeight:e.line_height},format:"truetype",id:e.id,styles:[{fontStyle:"",fontUrl:e.url,fontWeight:"normal",name:"normal"}]}}},872353:function(e,t,n){n.d(t,{j:()=>a});let i=RegExp("^[^A-Za-zÀ-ÖØ-öA-Za-zÀ-ÖØ-ö︀-﹯﻽-￿]*[֑-߿יִ-﷽ﹰ-ﻼ]");function a(e){return i.test(e||"")?"rtl":"ltr"}},720445:function(e,t,n){n.d(t,{ZP:()=>T});var i,a=n(281098),o=n(667294);n(422578);var s=n(20256),l=n(980787),r=n(289032),d=n(28427),c=n(115247),u=n(15667),p=n(149026),h=n(792171),m=n(589357),g=n(78762),y=n(785893);function _(e,t,n){var i;return(t="symbol"==typeof(i=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?i:i+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let f=(0,g.Z)(()=>Promise.all([n.e("25418"),n.e("22244"),n.e("31142")]).then(n.bind(n,509691)),void 0,e=>509691,"app-www-video-VideoWrapper",e=>["25418","22244","31142"]),b=[0,.25,.5,.75,.95,.97],v=[0,.5,.8,.99,1],x={rootMargin:"-64px 0px 0px 0px",threshold:[...m.iM]},P=Object.freeze({LOADING:0,PLAYING:1,PAUSED:2,STALLING:3}),S=(void 0!==i||(i=n(454387)).hash&&"93ed23334d5bac81ac8410f05c4f2031"!==i.hash&&console.error("The definition of 'VideoWithContextLogging_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i);function w(){return new Date().getTime()}function C(e){return!!e.volume&&e.volume>0}class k extends o.Component{constructor(e){super(e),_(this,"videoWrapperRef",(0,o.createRef)()),_(this,"handleWindowResize",()=>{if(!this.fullscreen){let e=this.getDimensions(),{height:t,width:n}=this.currentInterval;e.height!==t||e.width!==n?this.startNewInterval(e):(this.currentInterval.windowHeight=e.windowHeight,this.currentInterval.windowWidth=e.windowWidth)}}),_(this,"handlePlayheadDown",({event:e})=>{let{onPlayheadDown:t}=this.props;this.setState({seeking:!0}),t&&t({event:e})}),_(this,"handlePlayheadUp",({event:e})=>{let{onPlayheadUp:t}=this.props;this.setState({seeking:!1}),t&&t({event:e})}),_(this,"handleLoop",()=>{this.videoTime=0}),_(this,"handlePlaying",e=>{this.logVideoStart(),this.props.onPlaying&&this.props.onPlaying(e)}),_(this,"handleTimeChange",e=>{let{seeking:t,ready:n}=this.state;if(!this.currentInterval.videoDuration)return;let i=1e3*e.time,a=function(e,t,n,i){if(e>t||n<=0)return null;for(let a of i){let i=a*n;if(e<=i&&t>i)return a}return null}(this.videoTime,i,this.currentInterval.videoDuration,b);if("number"==typeof a&&this.props.playing&&!t&&n){let e=w();this.logVideoEvent(6906,{...this.currentInterval,startTime:e,endTime:e,videoStartTime:0,videoEndTime:0,quartile:Math.floor(4*a),quartilePercentValue:a})}this.videoTime=i,this.props.onTimeChange&&this.props.onTimeChange(e)}),_(this,"handleDurationChange",e=>{this.currentInterval.videoDuration=1e3*e.duration,this.props.onDurationChange&&this.props.onDurationChange(e)}),_(this,"handleReady",e=>{let{ready:t}=this.state;t||this.setState({ready:!0}),this.props.onReady&&this.props.onReady(e)}),_(this,"handleEnded",e=>{this.logFourthQuartileEvent(),this.props.loop&&(this.startNewInterval(),this.currentInterval.videoStartTime=0),this.props.onEnded&&this.props.onEnded(e)}),_(this,"handleVisibilityChange",e=>{if(0===e.length)return;let t=function(e){for(let t=0;t<v.length;t+=1){let n=v[t],i=v[t+1];if(null==i||n<=e&&e<i)return n}return null}(Number.parseFloat(e.slice(-1)[0].intersectionRatio.toFixed(2)));"number"==typeof t&&(this.visible=t>=.5),null==t||t===this.currentInterval.viewability||this.fullscreen||(0===t?this.startNewInterval({viewability:t,playbackState:P.PAUSED}):this.startNewInterval({viewability:t}))}),_(this,"handleFullscreenChange",({event:e,fullscreen:t})=>{if(t){let{height:e,width:t}=window.screen;this.startNewInterval({height:e,width:t,windowHeight:e,windowWidth:t})}else t||this.startNewInterval(this.getDimensions());this.fullscreen=t,this.props.onFullscreenChange&&this.props.onFullscreenChange({event:e,fullscreen:t})}),_(this,"handleClose",()=>{this.startNewInterval()}),this.state={ready:!1,seeking:!1,started:!1};let t=w();this.handleWindowResize=(0,r.Z)(this.handleWindowResize,1e3),this.currentInterval={videoDuration:0,startTime:t,endTime:t,videoStartTime:0,videoEndTime:0,isAudible:C(e),playbackState:this.getPlaybackState(e,this.state),quartile:-1,quartilePercentValue:0,height:null,width:null,windowHeight:null,windowWidth:null,viewability:null},this.videoTime=0,this.fullscreen=!1,this.visible=null}componentDidMount(){(0,a.Z)("VideoWithContextLogging","/app/www/video/VideoWithContextLogging.tsx"),this.currentInterval={...this.currentInterval,...this.getDimensions()},window.addEventListener("resize",this.handleWindowResize),window.addEventListener("beforeunload",this.handleClose)}componentDidUpdate(e,t){let n={};C(e)&&!C(this.props)?n.isAudible=!1:!C(e)&&C(this.props)&&(n.isAudible=!0);let i=this.getPlaybackState(this.props,this.state);this.getPlaybackState(e,t)!==i&&(n.playbackState=i),Object.keys(n).length>0&&this.startNewInterval(n)}componentWillUnmount(){window.removeEventListener("resize",this.handleWindowResize),window.removeEventListener("beforeunload",this.handleClose),this.startNewInterval()}getPlaybackState(e,t){return t.ready?e.playing&&!t.seeking?P.PLAYING:P.PAUSED:P.LOADING}getDimensions(){let e,t;if(this.videoWrapperRef.current){let n=this.videoWrapperRef.current;n.clientHeight&&n.clientWidth&&(e=n.clientHeight,t=n.clientWidth)}return{height:e,width:t,windowHeight:window.innerHeight,windowWidth:window.innerWidth}}logVideoEvent(e,t){let{closeupStoryPinViewability:n,contextLogData:i,logContextEvent:a,playing:o,surface:s}=this.props,{seeking:l}=this.state,{height:r,width:d,windowHeight:c,windowWidth:u,viewability:p,...h}=t;if(null!=r&&null!=d&&null!=c&&null!=u&&null!=p){let t={...h,gridAutoplay:6904===e&&o&&!l&&("AuthHomefeed"===s||"SearchItem"===s||"RelatedPinGrid"===s||"PdpRelatedPinGrid"===s),height:r,width:d,windowHeight:c,windowWidth:u,viewability:n||p};a({event_type:e,...function(e){let{eventData:{videoEvent:{gridAutoplay:t,videoDuration:n,startTime:i,endTime:a,videoStartTime:o,videoEndTime:s,isAudible:l,height:r,width:d,playbackState:c,quartile:u,quartilePercentValue:p,windowHeight:h,windowWidth:m,viewability:g}},component:y,objectId:_,view:f,viewParameter:b,...v}=e;return{component:y,object_id_str:_,view_type:f,view_parameter:b,aux_data:{...v},event_data:{videoEventData:{gridAutoplay:t,videoDuration:n?Math.floor(n):0,time:i,endTime:a,videoTime:o?Math.floor(o):0,endVideoTime:s?Math.floor(s):0,isAudible:l,height:r,width:d,playbackState:c,quartile:u,quartilePercentValue:p,windowHeight:h,windowWidth:m,viewability:g}}}}({...i,view:this.fullscreen?108:i.view,eventData:{videoEvent:t}})})}}logFourthQuartileEvent(){let e=w();this.logVideoEvent(6906,{...this.currentInterval,startTime:e,endTime:e,videoStartTime:0,videoEndTime:0,quartile:4,quartilePercentValue:1})}logVideoStart(){if(this.state.started)return;let{contextLogData:e,setVideoPlayed:t}=this.props;t(e.objectId),this.setState({started:!0})}startNewInterval(e){let t=w();this.logVideoEvent(6904,{...this.currentInterval,endTime:t,videoEndTime:this.videoTime}),this.currentInterval={...this.currentInterval,...e,startTime:t,videoStartTime:this.videoTime,endTime:-1,videoEndTime:-1}}render(){let{rootMargin:e,surface:t,aspectRatio:n,backgroundColor:i,captions:a,contextLogData:o,controls:l,fallback:r,hlsConfig:d,isAutoPlay:u,loop:h,objectFit:m,onLoadedChange:g,onControlsPause:_,onControlsPlay:b,onSeek:v,onVolumeChange:P,pin:S,playbackRate:w,playing:C,playsInline:k,poster:T,preload:I,seekTime:j,src:E,videoStartTime:A,volume:R,video:z,variant:L,setVideoRef:V}=this.props,{seeking:M}=this.state;return void 0!==e&&(x.rootMargin=t?(0,p.eL)(t):e),(0,y.jsx)(c.Z,{onVisibilityChange:this.handleVisibilityChange,options:x,children:e=>(0,y.jsx)(s.xu,{ref:t=>{e.current=t,this.videoWrapperRef.current=t},height:"inherit",children:(0,y.jsx)(f,{aspectRatio:n,backgroundColor:i,captions:a,contextLogData:o,controls:l,fallback:r,hlsConfig:d,isAutoPlay:u,loop:h,objectFit:m,onControlsPause:_,onControlsPlay:b,onDurationChange:this.handleDurationChange,onEnded:this.handleEnded,onFullscreenChange:this.handleFullscreenChange,onLoadedChange:g,onLoop:this.handleLoop,onPlay:()=>{},onPlayError:()=>{},onPlayheadDown:this.handlePlayheadDown,onPlayheadUp:this.handlePlayheadUp,onPlaying:this.handlePlaying,onReady:this.handleReady,onSeek:v,onTimeChange:this.handleTimeChange,onVolumeChange:P,pinKey:S,playbackRate:w,playing:!M&&C,playsInline:k,poster:T,preload:I,seekTime:j,setVideoRef:V,src:E,variant:L,video:z,videoStartTime:A,visible:this.visible,volume:R})})})}}function T(e){(0,o.useEffect)(()=>{(0,a.Z)("VideoWithContextLogging","/app/www/video/VideoWithContextLogging.tsx")},[]);let{pinKey:t}=e,n=(0,d.Z)(S,t),{logContextEvent:i}=(0,l.u)(),{setVideoPlayed:s}=(0,h.H)(),r=(0,u.B)();return(0,y.jsx)(k,{...e,logContextEvent:i,pin:n,requestContext:r,setVideoPlayed:s})}_(k,"defaultProps",s.nk.defaultProps)}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/3497-ac0364757ea38e51.mjs.map